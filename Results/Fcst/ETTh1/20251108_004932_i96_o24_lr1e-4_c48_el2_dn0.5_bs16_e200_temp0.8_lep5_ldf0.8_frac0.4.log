Namespace(device='cuda:0', root_path='./data/ETT-small', data_path='ETTh1', channel=48, num_nodes=7, seq_len=96, pred_len=24, batch_size=16, lrate=0.0001, dropout_n=0.5, d_llm=768, e_layer=2, head=4, model_path='./gpt2_model', tokenizer_path='./gpt2_tokenizer', weight_decay=0.001, feature_w=0.01, fcst_w=1, recon_w=0.5, att_w=0.01, num_workers=10, epochs=200, seed=6666, es_patience=50, save='./logs/2025-11-08-01:29:35-', num_users=10, frac=0.4, local_ep=5, all_clients=False, verbose=False, threshold=1, temperature=0.8, local_data_frac=0.8, vae_train_epochs=1, vae_local_epochs=10, shared_size=96)
The number of parameters: 1274640
Dual(
  (normalize_layers): Normalize()
  (length_to_feature): Linear(in_features=96, out_features=48, bias=True)
  (token_to_feature): Linear(in_features=768, out_features=48, bias=True)
  (ts_encoder): Encoder(
    (attn_layers): ModuleList(
      (0-1): 2 x EncoderLayer(
        (attention): AttentionLayer(
          (inner_attention): FullAttention(
            (dropout): Dropout(p=0.5, inplace=False)
          )
          (query_projection): Linear(in_features=48, out_features=48, bias=True)
          (key_projection): Linear(in_features=48, out_features=48, bias=True)
          (value_projection): Linear(in_features=48, out_features=48, bias=True)
          (out_projection): Linear(in_features=48, out_features=48, bias=True)
        )
        (conv1): Conv1d(48, 3072, kernel_size=(1,), stride=(1,))
        (conv2): Conv1d(3072, 48, kernel_size=(1,), stride=(1,))
        (norm1): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.5, inplace=False)
      )
    )
    (norm): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
  )
  (prompt_encoder): Encoder(
    (attn_layers): ModuleList(
      (0-1): 2 x EncoderLayer(
        (attention): AttentionLayer(
          (inner_attention): FullAttention(
            (dropout): Dropout(p=0.5, inplace=False)
          )
          (query_projection): Linear(in_features=48, out_features=48, bias=True)
          (key_projection): Linear(in_features=48, out_features=48, bias=True)
          (value_projection): Linear(in_features=48, out_features=48, bias=True)
          (out_projection): Linear(in_features=48, out_features=48, bias=True)
        )
        (conv1): Conv1d(48, 3072, kernel_size=(1,), stride=(1,))
        (conv2): Conv1d(3072, 48, kernel_size=(1,), stride=(1,))
        (norm1): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.5, inplace=False)
      )
    )
    (norm): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
  )
  (ts_proj): Linear(in_features=48, out_features=24, bias=True)
  (prompt_proj): Linear(in_features=48, out_features=24, bias=True)
)
Start training...
Shared data Epoch [10/10],client_1  Loss: 2.2605
Shared data Epoch [10/10],client_2  Loss: 1.6775
Shared data Epoch [10/10],client_3  Loss: 1.9845
Shared data Epoch [10/10],client_4  Loss: 1.7633
Shared data Epoch [10/10],client_5  Loss: 2.0152
Shared data Epoch [10/10],client_6  Loss: 2.5672
Shared data Epoch [10/10],client_7  Loss: 2.2453
Shared data Epoch [10/10],client_8  Loss: 2.7270
Shared data Epoch [10/10],client_9  Loss: 2.4447
Shared data Epoch [10/10],client_10  Loss: 2.6939
Shared data shape: x torch.Size([10, 96, 7]), emb torch.Size([10, 96, 768])
aggregation weights dict_items([('client_1', 0.23838408347780002), ('client_4', 0.26405789972595867), ('client_5', 0.24514290680352352), ('client_7', 0.2524151099927178)])
Epoch: 001, Training Time: 33.5963 secs
Epoch: 001, Validation Time: 1.5753 secs
-----------------------
Epoch: 001, Train Loss: 0.8967, Train MSE: 0.4882, Train MAE: 0.5081
Epoch: 001, Valid Loss: 0.6135, Valid MSE: 0.7700, Valid MAE: 0.6148
###Update tasks appear###
Updating! Valid Loss:0.6135, epoch:  1
aggregation weights dict_items([('client_8', 0.24354757664420182), ('client_1', 0.25500596955766675), ('client_4', 0.24725810628792697), ('client_6', 0.2541883475102045)])
Epoch: 002, Training Time: 33.1618 secs
Epoch: 002, Validation Time: 1.4848 secs
-----------------------
Epoch: 002, Train Loss: 0.5336, Train MSE: 0.4289, Train MAE: 0.4626
Epoch: 002, Valid Loss: 0.5486, Valid MSE: 0.6511, Valid MAE: 0.5619
###Update tasks appear###
Updating! Valid Loss:0.5486, epoch:  2
aggregation weights dict_items([('client_2', 0.25361964958422134), ('client_7', 0.240708519369921), ('client_10', 0.23858950168777548), ('client_8', 0.26708232935808224)])
Epoch: 003, Training Time: 34.8720 secs
Epoch: 003, Validation Time: 1.4445 secs
-----------------------
Epoch: 003, Train Loss: 0.4604, Train MSE: 0.4074, Train MAE: 0.4493
Epoch: 003, Valid Loss: 0.4869, Valid MSE: 0.5900, Valid MAE: 0.5307
###Update tasks appear###
Updating! Valid Loss:0.4869, epoch:  3
aggregation weights dict_items([('client_5', 0.26746075372302414), ('client_3', 0.24507635338328573), ('client_4', 0.24296823327439515), ('client_6', 0.24449465961929495)])
Epoch: 004, Training Time: 33.6551 secs
Epoch: 004, Validation Time: 1.5171 secs
-----------------------
Epoch: 004, Train Loss: 0.3874, Train MSE: 0.3461, Train MAE: 0.4200
Epoch: 004, Valid Loss: 0.4954, Valid MSE: 0.5859, Valid MAE: 0.5310
No update
aggregation weights dict_items([('client_10', 0.25450922852034796), ('client_5', 0.26319506276547516), ('client_1', 0.24248145694960882), ('client_3', 0.23981425176456805)])
Epoch: 005, Training Time: 33.3749 secs
Epoch: 005, Validation Time: 1.5255 secs
-----------------------
Epoch: 005, Train Loss: 0.3618, Train MSE: 0.3495, Train MAE: 0.4202
Epoch: 005, Valid Loss: 0.4664, Valid MSE: 0.5682, Valid MAE: 0.5220
###Update tasks appear###
Updating! Valid Loss:0.4664, epoch:  5
aggregation weights dict_items([('client_1', 0.2523718729032586), ('client_7', 0.24875352472700088), ('client_10', 0.2530539460970273), ('client_2', 0.24582065627271324)])
Epoch: 006, Training Time: 33.9626 secs
Epoch: 006, Validation Time: 1.5418 secs
-----------------------
Epoch: 006, Train Loss: 0.3349, Train MSE: 0.3313, Train MAE: 0.4090
Epoch: 006, Valid Loss: 0.4515, Valid MSE: 0.5467, Valid MAE: 0.5107
###Update tasks appear###
Updating! Valid Loss:0.4515, epoch:  6
aggregation weights dict_items([('client_3', 0.26091682553942724), ('client_1', 0.25853339224251237), ('client_4', 0.2437526370206971), ('client_8', 0.23679714519736333)])
Epoch: 007, Training Time: 34.3853 secs
Epoch: 007, Validation Time: 2.0249 secs
-----------------------
Epoch: 007, Train Loss: 0.3248, Train MSE: 0.3685, Train MAE: 0.4252
Epoch: 007, Valid Loss: 0.4412, Valid MSE: 0.5439, Valid MAE: 0.5092
###Update tasks appear###
Updating! Valid Loss:0.4412, epoch:  7
aggregation weights dict_items([('client_7', 0.24872336497743908), ('client_5', 0.25816405160870215), ('client_9', 0.250467603647955), ('client_2', 0.24264497976590368)])
Epoch: 008, Training Time: 33.7510 secs
Epoch: 008, Validation Time: 1.5099 secs
-----------------------
Epoch: 008, Train Loss: 0.3122, Train MSE: 0.3497, Train MAE: 0.4188
Epoch: 008, Valid Loss: 0.4201, Valid MSE: 0.5195, Valid MAE: 0.4960
###Update tasks appear###
Updating! Valid Loss:0.4201, epoch:  8
aggregation weights dict_items([('client_6', 0.26819793366478245), ('client_8', 0.2491811303175344), ('client_3', 0.24778513739629998), ('client_2', 0.2348357986213832)])
Epoch: 009, Training Time: 34.2178 secs
Epoch: 009, Validation Time: 1.4014 secs
-----------------------
Epoch: 009, Train Loss: 0.2649, Train MSE: 0.3007, Train MAE: 0.3823
Epoch: 009, Valid Loss: 0.4212, Valid MSE: 0.5250, Valid MAE: 0.4999
No update
aggregation weights dict_items([('client_5', 0.2539288552576718), ('client_9', 0.2714948586260146), ('client_8', 0.22839311026721815), ('client_3', 0.24618317584909546)])
Epoch: 010, Training Time: 34.2453 secs
Epoch: 010, Validation Time: 1.6005 secs
-----------------------
Epoch: 010, Train Loss: 0.2868, Train MSE: 0.3609, Train MAE: 0.4184
Epoch: 010, Valid Loss: 0.4063, Valid MSE: 0.4950, Valid MAE: 0.4820
###Update tasks appear###
Updating! Valid Loss:0.4063, epoch:  10
aggregation weights dict_items([('client_6', 0.24829201153436026), ('client_4', 0.26876530871223614), ('client_3', 0.23614243735210289), ('client_2', 0.24680024240130077)])
Epoch: 011, Training Time: 34.2093 secs
Epoch: 011, Validation Time: 1.4795 secs
-----------------------
Epoch: 011, Train Loss: 0.2344, Train MSE: 0.2724, Train MAE: 0.3680
Epoch: 011, Valid Loss: 0.4135, Valid MSE: 0.5037, Valid MAE: 0.4895
No update
aggregation weights dict_items([('client_5', 0.25777796695562644), ('client_1', 0.24351447759608869), ('client_2', 0.23170641190284547), ('client_4', 0.26700114354543947)])
Epoch: 012, Training Time: 33.7255 secs
Epoch: 012, Validation Time: 1.5007 secs
-----------------------
Epoch: 012, Train Loss: 0.2472, Train MSE: 0.3095, Train MAE: 0.3940
Epoch: 012, Valid Loss: 0.4138, Valid MSE: 0.4968, Valid MAE: 0.4852
No update
aggregation weights dict_items([('client_10', 0.26289942683330997), ('client_6', 0.242198647234817), ('client_1', 0.2584218558158162), ('client_3', 0.2364800701160569)])
Epoch: 013, Training Time: 34.3774 secs
Epoch: 013, Validation Time: 1.5128 secs
-----------------------
Epoch: 013, Train Loss: 0.2188, Train MSE: 0.2588, Train MAE: 0.3563
Epoch: 013, Valid Loss: 0.3903, Valid MSE: 0.4691, Valid MAE: 0.4683
###Update tasks appear###
Test low! Updating! Test MSE: 0.3655, Test MAE: 0.3950, Test low! Updating! Valid Loss: 0.3903, epoch:  13
aggregation weights dict_items([('client_2', 0.23285879708016308), ('client_1', 0.25400611665907097), ('client_8', 0.27956820254052145), ('client_6', 0.2335668837202445)])
Epoch: 014, Training Time: 34.8157 secs
Epoch: 014, Validation Time: 1.5876 secs
-----------------------
Epoch: 014, Train Loss: 0.2250, Train MSE: 0.2865, Train MAE: 0.3708
Epoch: 014, Valid Loss: 0.3916, Valid MSE: 0.4655, Valid MAE: 0.4657
No update
aggregation weights dict_items([('client_9', 0.26800524188811886), ('client_1', 0.24743462973014155), ('client_5', 0.23360910788014236), ('client_6', 0.2509510205015973)])
Epoch: 015, Training Time: 34.9261 secs
Epoch: 015, Validation Time: 2.2046 secs
-----------------------
Epoch: 015, Train Loss: 0.2250, Train MSE: 0.2860, Train MAE: 0.3735
Epoch: 015, Valid Loss: 0.3779, Valid MSE: 0.4495, Valid MAE: 0.4558
###Update tasks appear###
Test low! Updating! Test MSE: 0.3493, Test MAE: 0.3851, Test low! Updating! Valid Loss: 0.3779, epoch:  15
aggregation weights dict_items([('client_5', 0.2725475827081885), ('client_10', 0.257129621636971), ('client_7', 0.22840644811934732), ('client_4', 0.24191634753549313)])
Epoch: 016, Training Time: 34.4831 secs
Epoch: 016, Validation Time: 1.4862 secs
-----------------------
Epoch: 016, Train Loss: 0.2286, Train MSE: 0.2953, Train MAE: 0.3801
Epoch: 016, Valid Loss: 0.3695, Valid MSE: 0.4298, Valid MAE: 0.4441
###Update tasks appear###
Test low! Updating! Test MSE: 0.3424, Test MAE: 0.3816, Test low! Updating! Valid Loss: 0.3695, epoch:  16
aggregation weights dict_items([('client_4', 0.24835112826599837), ('client_2', 0.2401552788999361), ('client_1', 0.25899161696932266), ('client_5', 0.252501975864743)])
Epoch: 017, Training Time: 33.7537 secs
Epoch: 017, Validation Time: 1.5348 secs
-----------------------
Epoch: 017, Train Loss: 0.2136, Train MSE: 0.2836, Train MAE: 0.3732
Epoch: 017, Valid Loss: 0.3808, Valid MSE: 0.4454, Valid MAE: 0.4557
No update
aggregation weights dict_items([('client_5', 0.21392532710278292), ('client_8', 0.275684617952667), ('client_9', 0.30095810252235433), ('client_7', 0.20943195242219576)])
Epoch: 018, Training Time: 34.5481 secs
Epoch: 018, Validation Time: 1.4799 secs
-----------------------
Epoch: 018, Train Loss: 0.2389, Train MSE: 0.3256, Train MAE: 0.3940
Epoch: 018, Valid Loss: 0.3573, Valid MSE: 0.4163, Valid MAE: 0.4345
###Update tasks appear###
Test low! Updating! Test MSE: 0.3274, Test MAE: 0.3731, Test low! Updating! Valid Loss: 0.3573, epoch:  18
aggregation weights dict_items([('client_1', 0.24076874042924418), ('client_10', 0.25870101859815514), ('client_2', 0.22943330662968012), ('client_5', 0.2710969343429205)])
Epoch: 019, Training Time: 36.1712 secs
Epoch: 019, Validation Time: 1.5793 secs
-----------------------
Epoch: 019, Train Loss: 0.2049, Train MSE: 0.2687, Train MAE: 0.3613
Epoch: 019, Valid Loss: 0.3617, Valid MSE: 0.4199, Valid MAE: 0.4387
No update
aggregation weights dict_items([('client_7', 0.2628023262769519), ('client_4', 0.25977938004009554), ('client_8', 0.25478386801669883), ('client_2', 0.22263442566625385)])
Epoch: 020, Training Time: 35.1089 secs
Epoch: 020, Validation Time: 1.4325 secs
-----------------------
Epoch: 020, Train Loss: 0.2170, Train MSE: 0.2993, Train MAE: 0.3772
Epoch: 020, Valid Loss: 0.3444, Valid MSE: 0.4112, Valid MAE: 0.4323
###Update tasks appear###
Test low! Updating! Test MSE: 0.3261, Test MAE: 0.3722, Test low! Updating! Valid Loss: 0.3444, epoch:  20
aggregation weights dict_items([('client_9', 0.27908840216302644), ('client_1', 0.2311961927953407), ('client_10', 0.26706961262014695), ('client_2', 0.222645792421486)])
Epoch: 021, Training Time: 35.2128 secs
Epoch: 021, Validation Time: 1.5681 secs
-----------------------
Epoch: 021, Train Loss: 0.2070, Train MSE: 0.2757, Train MAE: 0.3630
Epoch: 021, Valid Loss: 0.3431, Valid MSE: 0.4054, Valid MAE: 0.4279
###Update tasks appear###
Test low! Updating! Test MSE: 0.3258, Test MAE: 0.3722, Test low! Updating! Valid Loss: 0.3431, epoch:  21
aggregation weights dict_items([('client_8', 0.23665057133386228), ('client_6', 0.228637943581245), ('client_4', 0.2811229506837362), ('client_1', 0.2535885344011565)])
Epoch: 022, Training Time: 34.6124 secs
Epoch: 022, Validation Time: 2.1005 secs
-----------------------
Epoch: 022, Train Loss: 0.2012, Train MSE: 0.2768, Train MAE: 0.3623
Epoch: 022, Valid Loss: 0.3421, Valid MSE: 0.4032, Valid MAE: 0.4274
###Update tasks appear###
Test low! Updating! Test MSE: 0.3235, Test MAE: 0.3703, Test low! Updating! Valid Loss: 0.3421, epoch:  22
aggregation weights dict_items([('client_10', 0.2794581514568344), ('client_7', 0.25844802332960104), ('client_8', 0.26162103343331555), ('client_3', 0.20047279178024893)])
Epoch: 023, Training Time: 34.9099 secs
Epoch: 023, Validation Time: 1.5543 secs
-----------------------
Epoch: 023, Train Loss: 0.1989, Train MSE: 0.2720, Train MAE: 0.3573
Epoch: 023, Valid Loss: 0.3359, Valid MSE: 0.3983, Valid MAE: 0.4226
###Update tasks appear###
Test low! Updating! Test MSE: 0.3139, Test MAE: 0.3652, Test low! Updating! Valid Loss: 0.3359, epoch:  23
aggregation weights dict_items([('client_7', 0.24208040534833242), ('client_1', 0.2589054849722468), ('client_10', 0.2642495349012662), ('client_3', 0.23476457477815468)])
Epoch: 024, Training Time: 34.9167 secs
Epoch: 024, Validation Time: 1.5730 secs
-----------------------
Epoch: 024, Train Loss: 0.1849, Train MSE: 0.2464, Train MAE: 0.3422
Epoch: 024, Valid Loss: 0.3308, Valid MSE: 0.3965, Valid MAE: 0.4219
###Update tasks appear###
No update
aggregation weights dict_items([('client_6', 0.22387940731374067), ('client_1', 0.22691975561476177), ('client_7', 0.26365322450393003), ('client_10', 0.2855476125675675)])
Epoch: 025, Training Time: 34.2077 secs
Epoch: 025, Validation Time: 1.4768 secs
-----------------------
Epoch: 025, Train Loss: 0.1785, Train MSE: 0.2337, Train MAE: 0.3342
Epoch: 025, Valid Loss: 0.3313, Valid MSE: 0.3939, Valid MAE: 0.4193
###Update tasks appear###
Test low! Updating! Test MSE: 0.3114, Test MAE: 0.3637, Test low! Updating! Valid Loss: 0.3313, epoch:  25
aggregation weights dict_items([('client_6', 0.2085530102568306), ('client_8', 0.27216423770374915), ('client_3', 0.2348886590785225), ('client_7', 0.28439409296089774)])
Epoch: 026, Training Time: 34.4985 secs
Epoch: 026, Validation Time: 2.2311 secs
-----------------------
Epoch: 026, Train Loss: 0.1790, Train MSE: 0.2467, Train MAE: 0.3402
Epoch: 026, Valid Loss: 0.3395, Valid MSE: 0.3981, Valid MAE: 0.4217
No update
aggregation weights dict_items([('client_10', 0.2843638026097667), ('client_3', 0.22023498871045527), ('client_2', 0.2612086915980035), ('client_6', 0.23419251708177452)])
Epoch: 027, Training Time: 33.7764 secs
Epoch: 027, Validation Time: 1.4950 secs
-----------------------
Epoch: 027, Train Loss: 0.1637, Train MSE: 0.2136, Train MAE: 0.3198
Epoch: 027, Valid Loss: 0.3317, Valid MSE: 0.4012, Valid MAE: 0.4243
No update
aggregation weights dict_items([('client_8', 0.25512890075627626), ('client_9', 0.2320568892212791), ('client_3', 0.24451516603656945), ('client_4', 0.2682990439858752)])
Epoch: 028, Training Time: 34.2334 secs
Epoch: 028, Validation Time: 1.3536 secs
-----------------------
Epoch: 028, Train Loss: 0.1998, Train MSE: 0.2905, Train MAE: 0.3672
Epoch: 028, Valid Loss: 0.3331, Valid MSE: 0.3907, Valid MAE: 0.4187
No update
aggregation weights dict_items([('client_10', 0.3074231021433266), ('client_2', 0.23173705513633833), ('client_4', 0.256141678118108), ('client_3', 0.20469816460222706)])
Epoch: 029, Training Time: 34.5405 secs
Epoch: 029, Validation Time: 1.5302 secs
-----------------------
Epoch: 029, Train Loss: 0.1740, Train MSE: 0.2392, Train MAE: 0.3363
Epoch: 029, Valid Loss: 0.3322, Valid MSE: 0.3931, Valid MAE: 0.4207
No update
aggregation weights dict_items([('client_2', 0.19722272687240647), ('client_8', 0.25967212727857614), ('client_10', 0.2482317191056013), ('client_9', 0.2948734267434161)])
Epoch: 030, Training Time: 34.5499 secs
Epoch: 030, Validation Time: 1.4540 secs
-----------------------
Epoch: 030, Train Loss: 0.1963, Train MSE: 0.2818, Train MAE: 0.3627
Epoch: 030, Valid Loss: 0.3195, Valid MSE: 0.3875, Valid MAE: 0.4152
###Update tasks appear###
Test low! Updating! Test MSE: 0.3073, Test MAE: 0.3603, Test low! Updating! Valid Loss: 0.3195, epoch:  30
aggregation weights dict_items([('client_3', 0.21372799857713198), ('client_4', 0.29336663392742307), ('client_10', 0.27107354167760894), ('client_6', 0.22183182581783603)])
Epoch: 031, Training Time: 34.5398 secs
Epoch: 031, Validation Time: 1.5644 secs
-----------------------
Epoch: 031, Train Loss: 0.1612, Train MSE: 0.2188, Train MAE: 0.3212
Epoch: 031, Valid Loss: 0.3271, Valid MSE: 0.3855, Valid MAE: 0.4152
No update
aggregation weights dict_items([('client_8', 0.2720372272151881), ('client_9', 0.3119635678781731), ('client_2', 0.20713161144066566), ('client_3', 0.20886759346597303)])
Epoch: 032, Training Time: 34.3506 secs
Epoch: 032, Validation Time: 1.5469 secs
-----------------------
Epoch: 032, Train Loss: 0.1864, Train MSE: 0.2706, Train MAE: 0.3551
Epoch: 032, Valid Loss: 0.3203, Valid MSE: 0.3854, Valid MAE: 0.4142
No update
aggregation weights dict_items([('client_9', 0.30425892955580325), ('client_6', 0.21894741534780526), ('client_10', 0.24899875543522992), ('client_3', 0.2277948996611615)])
Epoch: 033, Training Time: 34.8957 secs
Epoch: 033, Validation Time: 1.5197 secs
-----------------------
Epoch: 033, Train Loss: 0.1639, Train MSE: 0.2254, Train MAE: 0.3237
Epoch: 033, Valid Loss: 0.3197, Valid MSE: 0.3861, Valid MAE: 0.4141
No update
aggregation weights dict_items([('client_1', 0.25773293500521055), ('client_4', 0.26674810962404694), ('client_5', 0.23691047801009243), ('client_6', 0.23860847736065005)])
Epoch: 034, Training Time: 34.4415 secs
Epoch: 034, Validation Time: 1.5635 secs
-----------------------
Epoch: 034, Train Loss: 0.1742, Train MSE: 0.2413, Train MAE: 0.3396
Epoch: 034, Valid Loss: 0.3260, Valid MSE: 0.3862, Valid MAE: 0.4166
No update
aggregation weights dict_items([('client_9', 0.32959422454176596), ('client_2', 0.2203776630205154), ('client_3', 0.21208689596403899), ('client_10', 0.23794121647367952)])
Epoch: 035, Training Time: 34.4710 secs
Epoch: 035, Validation Time: 1.4245 secs
-----------------------
Epoch: 035, Train Loss: 0.1709, Train MSE: 0.2401, Train MAE: 0.3353
Epoch: 035, Valid Loss: 0.3179, Valid MSE: 0.3835, Valid MAE: 0.4131
###Update tasks appear###
No update
aggregation weights dict_items([('client_2', 0.20465450174719535), ('client_5', 0.26990827388545735), ('client_10', 0.2821396472489695), ('client_8', 0.2432975771183778)])
Epoch: 036, Training Time: 34.8765 secs
Epoch: 036, Validation Time: 1.5459 secs
-----------------------
Epoch: 036, Train Loss: 0.1833, Train MSE: 0.2662, Train MAE: 0.3540
Epoch: 036, Valid Loss: 0.3149, Valid MSE: 0.3798, Valid MAE: 0.4107
###Update tasks appear###
No update
aggregation weights dict_items([('client_8', 0.2791731179292961), ('client_3', 0.2123292546959892), ('client_5', 0.24064014857727434), ('client_9', 0.26785747879744026)])
Epoch: 037, Training Time: 34.6705 secs
Epoch: 037, Validation Time: 1.3789 secs
-----------------------
Epoch: 037, Train Loss: 0.1830, Train MSE: 0.2736, Train MAE: 0.3563
Epoch: 037, Valid Loss: 0.3207, Valid MSE: 0.3816, Valid MAE: 0.4122
No update
aggregation weights dict_items([('client_4', 0.2589582337836056), ('client_2', 0.2550690354057225), ('client_8', 0.2632008543552738), ('client_5', 0.2227718764553981)])
Epoch: 038, Training Time: 34.0744 secs
Epoch: 038, Validation Time: 1.4394 secs
-----------------------
Epoch: 038, Train Loss: 0.1841, Train MSE: 0.2704, Train MAE: 0.3585
Epoch: 038, Valid Loss: 0.3189, Valid MSE: 0.3815, Valid MAE: 0.4127
###Update tasks appear###
No update
aggregation weights dict_items([('client_7', 0.24701332807351756), ('client_4', 0.24736219722634334), ('client_8', 0.30591810656275303), ('client_3', 0.19970636813738607)])
Epoch: 039, Training Time: 34.1631 secs
Epoch: 039, Validation Time: 1.5307 secs
-----------------------
Epoch: 039, Train Loss: 0.1766, Train MSE: 0.2593, Train MAE: 0.3473
Epoch: 039, Valid Loss: 0.3201, Valid MSE: 0.3778, Valid MAE: 0.4097
No update
aggregation weights dict_items([('client_5', 0.2201706446935317), ('client_8', 0.25460203651400826), ('client_3', 0.20969661723305416), ('client_9', 0.31553070155940593)])
Epoch: 040, Training Time: 34.0277 secs
Epoch: 040, Validation Time: 1.5313 secs
-----------------------
Epoch: 040, Train Loss: 0.1782, Train MSE: 0.2670, Train MAE: 0.3519
Epoch: 040, Valid Loss: 0.3208, Valid MSE: 0.3805, Valid MAE: 0.4115
No update
aggregation weights dict_items([('client_3', 0.2284907485612625), ('client_4', 0.25017061759395565), ('client_7', 0.28258049368015753), ('client_10', 0.23875814016462424)])
Epoch: 041, Training Time: 34.1484 secs
Epoch: 041, Validation Time: 1.5356 secs
-----------------------
Epoch: 041, Train Loss: 0.1659, Train MSE: 0.2357, Train MAE: 0.3313
Epoch: 041, Valid Loss: 0.3185, Valid MSE: 0.3760, Valid MAE: 0.4080
###Update tasks appear###
No update
aggregation weights dict_items([('client_5', 0.27359194568784195), ('client_2', 0.23936352648429074), ('client_4', 0.24587740423479612), ('client_6', 0.24116712359307121)])
Epoch: 042, Training Time: 34.0811 secs
Epoch: 042, Validation Time: 1.5365 secs
-----------------------
Epoch: 042, Train Loss: 0.1617, Train MSE: 0.2261, Train MAE: 0.3285
Epoch: 042, Valid Loss: 0.3205, Valid MSE: 0.3822, Valid MAE: 0.4134
No update
aggregation weights dict_items([('client_4', 0.2725811287082418), ('client_2', 0.21469494794158986), ('client_5', 0.2733227437150134), ('client_7', 0.23940117963515498)])
Epoch: 043, Training Time: 34.3348 secs
Epoch: 043, Validation Time: 1.5303 secs
-----------------------
Epoch: 043, Train Loss: 0.1704, Train MSE: 0.2446, Train MAE: 0.3419
Epoch: 043, Valid Loss: 0.3202, Valid MSE: 0.3815, Valid MAE: 0.4127
No update
aggregation weights dict_items([('client_2', 0.23931420682625626), ('client_8', 0.2900955423787471), ('client_3', 0.250779851680254), ('client_5', 0.21981039911474273)])
Epoch: 044, Training Time: 34.5843 secs
Epoch: 044, Validation Time: 1.5887 secs
-----------------------
Epoch: 044, Train Loss: 0.1666, Train MSE: 0.2450, Train MAE: 0.3397
Epoch: 044, Valid Loss: 0.3208, Valid MSE: 0.3839, Valid MAE: 0.4140
No update
aggregation weights dict_items([('client_10', 0.2706321777337431), ('client_7', 0.23799596607495524), ('client_5', 0.26826411184765775), ('client_1', 0.22310774434364392)])
Epoch: 045, Training Time: 34.3858 secs
Epoch: 045, Validation Time: 1.4885 secs
-----------------------
Epoch: 045, Train Loss: 0.1733, Train MSE: 0.2459, Train MAE: 0.3416
Epoch: 045, Valid Loss: 0.3156, Valid MSE: 0.3778, Valid MAE: 0.4091
###Update tasks appear###
No update
aggregation weights dict_items([('client_10', 0.2594496901275043), ('client_3', 0.21118139235054242), ('client_1', 0.22197723736857908), ('client_9', 0.30739168015337415)])
Epoch: 046, Training Time: 34.0617 secs
Epoch: 046, Validation Time: 1.4470 secs
-----------------------
Epoch: 046, Train Loss: 0.1685, Train MSE: 0.2420, Train MAE: 0.3350
Epoch: 046, Valid Loss: 0.3112, Valid MSE: 0.3754, Valid MAE: 0.4073
###Update tasks appear###
No update
aggregation weights dict_items([('client_7', 0.2450760057350148), ('client_10', 0.27213577533476946), ('client_5', 0.2176354653375179), ('client_8', 0.2651527535926978)])
Epoch: 047, Training Time: 34.0976 secs
Epoch: 047, Validation Time: 1.5764 secs
-----------------------
Epoch: 047, Train Loss: 0.1765, Train MSE: 0.2614, Train MAE: 0.3500
Epoch: 047, Valid Loss: 0.3136, Valid MSE: 0.3749, Valid MAE: 0.4069
###Update tasks appear###
Test low! Updating! Test MSE: 0.3026, Test MAE: 0.3559, Test low! Updating! Valid Loss: 0.3136, epoch:  47
aggregation weights dict_items([('client_5', 0.25740631957754795), ('client_9', 0.276887593262432), ('client_6', 0.22807403296750103), ('client_7', 0.23763205419251898)])
Epoch: 048, Training Time: 34.7167 secs
Epoch: 048, Validation Time: 1.5104 secs
-----------------------
Epoch: 048, Train Loss: 0.1638, Train MSE: 0.2349, Train MAE: 0.3314
Epoch: 048, Valid Loss: 0.3197, Valid MSE: 0.3761, Valid MAE: 0.4071
No update
aggregation weights dict_items([('client_1', 0.25666915099621224), ('client_10', 0.25713881836404284), ('client_7', 0.24888970647766892), ('client_5', 0.23730232416207606)])
Epoch: 049, Training Time: 33.9810 secs
Epoch: 049, Validation Time: 1.5462 secs
-----------------------
Epoch: 049, Train Loss: 0.1689, Train MSE: 0.2412, Train MAE: 0.3374
Epoch: 049, Valid Loss: 0.3107, Valid MSE: 0.3741, Valid MAE: 0.4062
###Update tasks appear###
No update
aggregation weights dict_items([('client_1', 0.23174456668636068), ('client_10', 0.2888404628865443), ('client_6', 0.23506324162208977), ('client_9', 0.24435172880500516)])
Epoch: 050, Training Time: 34.1010 secs
Epoch: 050, Validation Time: 1.5254 secs
-----------------------
Epoch: 050, Train Loss: 0.1647, Train MSE: 0.2350, Train MAE: 0.3304
Epoch: 050, Valid Loss: 0.3078, Valid MSE: 0.3748, Valid MAE: 0.4066
###Update tasks appear###
Test low! Updating! Test MSE: 0.3018, Test MAE: 0.3555, Test low! Updating! Valid Loss: 0.3078, epoch:  50
aggregation weights dict_items([('client_7', 0.2386530742391921), ('client_2', 0.21979130866598337), ('client_8', 0.26965508784121967), ('client_10', 0.27190052925360486)])
Epoch: 051, Training Time: 34.6717 secs
Epoch: 051, Validation Time: 1.5321 secs
-----------------------
Epoch: 051, Train Loss: 0.1733, Train MSE: 0.2540, Train MAE: 0.3445
Epoch: 051, Valid Loss: 0.3063, Valid MSE: 0.3763, Valid MAE: 0.4072
###Update tasks appear###
Test low! Updating! Test MSE: 0.2981, Test MAE: 0.3528, Test low! Updating! Valid Loss: 0.3063, epoch:  51
aggregation weights dict_items([('client_10', 0.2735627484054471), ('client_8', 0.24254626487505876), ('client_7', 0.25111344284788295), ('client_6', 0.23277754387161118)])
Epoch: 052, Training Time: 34.1787 secs
Epoch: 052, Validation Time: 1.4673 secs
-----------------------
Epoch: 052, Train Loss: 0.1625, Train MSE: 0.2384, Train MAE: 0.3322
Epoch: 052, Valid Loss: 0.3144, Valid MSE: 0.3766, Valid MAE: 0.4074
No update
aggregation weights dict_items([('client_3', 0.2242409766789501), ('client_4', 0.2806235210406551), ('client_9', 0.2785344884592866), ('client_6', 0.21660101382110813)])
Epoch: 053, Training Time: 34.4462 secs
Epoch: 053, Validation Time: 1.5549 secs
-----------------------
Epoch: 053, Train Loss: 0.1577, Train MSE: 0.2285, Train MAE: 0.3241
Epoch: 053, Valid Loss: 0.3139, Valid MSE: 0.3727, Valid MAE: 0.4060
No update
aggregation weights dict_items([('client_4', 0.2793175097315089), ('client_5', 0.2599842364385861), ('client_6', 0.22104927470620656), ('client_2', 0.2396489791236985)])
Epoch: 054, Training Time: 42.7890 secs
Epoch: 054, Validation Time: 2.2598 secs
-----------------------
Epoch: 054, Train Loss: 0.1560, Train MSE: 0.2211, Train MAE: 0.3238
Epoch: 054, Valid Loss: 0.3123, Valid MSE: 0.3762, Valid MAE: 0.4086
No update
aggregation weights dict_items([('client_6', 0.22048503185858812), ('client_4', 0.2630448634559011), ('client_5', 0.2689793868502136), ('client_2', 0.24749071783529714)])
Epoch: 055, Training Time: 35.5018 secs
Epoch: 055, Validation Time: 1.5734 secs
-----------------------
Epoch: 055, Train Loss: 0.1534, Train MSE: 0.2179, Train MAE: 0.3225
Epoch: 055, Valid Loss: 0.3157, Valid MSE: 0.3796, Valid MAE: 0.4114
No update
aggregation weights dict_items([('client_3', 0.2672993611590407), ('client_5', 0.22273136353363984), ('client_2', 0.2563467686442411), ('client_6', 0.2536225066630783)])
Epoch: 056, Training Time: 36.6156 secs
Epoch: 056, Validation Time: 1.4298 secs
-----------------------
Epoch: 056, Train Loss: 0.1420, Train MSE: 0.1984, Train MAE: 0.3092
Epoch: 056, Valid Loss: 0.3178, Valid MSE: 0.3835, Valid MAE: 0.4133
No update
aggregation weights dict_items([('client_2', 0.22058041081724836), ('client_10', 0.2659671717217027), ('client_9', 0.30355435614192805), ('client_3', 0.20989806131912095)])
Epoch: 057, Training Time: 35.7015 secs
Epoch: 057, Validation Time: 1.5368 secs
-----------------------
Epoch: 057, Train Loss: 0.1607, Train MSE: 0.2309, Train MAE: 0.3278
Epoch: 057, Valid Loss: 0.3094, Valid MSE: 0.3766, Valid MAE: 0.4078
No update
aggregation weights dict_items([('client_2', 0.2285381229311314), ('client_5', 0.3032449910265382), ('client_3', 0.20106146080459172), ('client_10', 0.2671554252377387)])
Epoch: 058, Training Time: 35.3321 secs
Epoch: 058, Validation Time: 1.6088 secs
-----------------------
Epoch: 058, Train Loss: 0.1513, Train MSE: 0.2166, Train MAE: 0.3210
Epoch: 058, Valid Loss: 0.3096, Valid MSE: 0.3777, Valid MAE: 0.4089
No update
aggregation weights dict_items([('client_10', 0.2631748161222215), ('client_4', 0.2210674427654962), ('client_7', 0.2385743033470389), ('client_9', 0.2771834377652435)])
Epoch: 059, Training Time: 35.3909 secs
Epoch: 059, Validation Time: 1.5462 secs
-----------------------
Epoch: 059, Train Loss: 0.1734, Train MSE: 0.2554, Train MAE: 0.3436
Epoch: 059, Valid Loss: 0.3074, Valid MSE: 0.3716, Valid MAE: 0.4042
No update
aggregation weights dict_items([('client_8', 0.26764750212194616), ('client_4', 0.23927522371306742), ('client_1', 0.2712810950051648), ('client_3', 0.2217961791598217)])
Epoch: 060, Training Time: 35.2195 secs
Epoch: 060, Validation Time: 1.5780 secs
-----------------------
Epoch: 060, Train Loss: 0.1732, Train MSE: 0.2601, Train MAE: 0.3468
Epoch: 060, Valid Loss: 0.3062, Valid MSE: 0.3746, Valid MAE: 0.4077
###Update tasks appear###
No update
aggregation weights dict_items([('client_9', 0.2738812994329695), ('client_8', 0.2749636541266102), ('client_7', 0.2393755148459606), ('client_2', 0.2117795315944597)])
Epoch: 061, Training Time: 35.4101 secs
Epoch: 061, Validation Time: 1.5443 secs
-----------------------
Epoch: 061, Train Loss: 0.1795, Train MSE: 0.2690, Train MAE: 0.3535
Epoch: 061, Valid Loss: 0.3058, Valid MSE: 0.3739, Valid MAE: 0.4061
###Update tasks appear###
Test low! Updating! Test MSE: 0.2970, Test MAE: 0.3512, Test low! Updating! Valid Loss: 0.3058, epoch:  61
aggregation weights dict_items([('client_10', 0.24913771660736547), ('client_7', 0.26665497558181606), ('client_5', 0.2688158600123102), ('client_3', 0.2153914477985083)])
Epoch: 062, Training Time: 35.6942 secs
Epoch: 062, Validation Time: 1.4731 secs
-----------------------
Epoch: 062, Train Loss: 0.1528, Train MSE: 0.2206, Train MAE: 0.3221
Epoch: 062, Valid Loss: 0.3077, Valid MSE: 0.3726, Valid MAE: 0.4048
No update
aggregation weights dict_items([('client_4', 0.2625261706257013), ('client_2', 0.2495595907572736), ('client_1', 0.2701468805885254), ('client_7', 0.21776735802849972)])
Epoch: 063, Training Time: 34.7997 secs
Epoch: 063, Validation Time: 1.5626 secs
-----------------------
Epoch: 063, Train Loss: 0.1693, Train MSE: 0.2410, Train MAE: 0.3376
Epoch: 063, Valid Loss: 0.3074, Valid MSE: 0.3722, Valid MAE: 0.4053
No update
aggregation weights dict_items([('client_1', 0.23937788066686633), ('client_8', 0.2635761650715644), ('client_5', 0.2401891945857301), ('client_4', 0.2568567596758392)])
Epoch: 064, Training Time: 35.8905 secs
Epoch: 064, Validation Time: 1.4707 secs
-----------------------
Epoch: 064, Train Loss: 0.1780, Train MSE: 0.2695, Train MAE: 0.3557
Epoch: 064, Valid Loss: 0.3080, Valid MSE: 0.3759, Valid MAE: 0.4086
No update
aggregation weights dict_items([('client_9', 0.2760421280517236), ('client_1', 0.24591101525745168), ('client_3', 0.1920809672114765), ('client_4', 0.2859658894793483)])
Epoch: 065, Training Time: 34.0255 secs
Epoch: 065, Validation Time: 1.4636 secs
-----------------------
Epoch: 065, Train Loss: 0.1656, Train MSE: 0.2441, Train MAE: 0.3366
Epoch: 065, Valid Loss: 0.3081, Valid MSE: 0.3746, Valid MAE: 0.4078
No update
aggregation weights dict_items([('client_9', 0.27928133570604735), ('client_4', 0.2460527623466498), ('client_3', 0.21573929456242172), ('client_7', 0.2589266073848811)])
Epoch: 066, Training Time: 35.1811 secs
Epoch: 066, Validation Time: 1.5892 secs
-----------------------
Epoch: 066, Train Loss: 0.1627, Train MSE: 0.2397, Train MAE: 0.3332
Epoch: 066, Valid Loss: 0.3111, Valid MSE: 0.3715, Valid MAE: 0.4046
No update
aggregation weights dict_items([('client_6', 0.2208423805666307), ('client_3', 0.22252854115888218), ('client_9', 0.31362024945214867), ('client_2', 0.2430088288223386)])
Epoch: 067, Training Time: 34.4596 secs
Epoch: 067, Validation Time: 1.6522 secs
-----------------------
Epoch: 067, Train Loss: 0.1490, Train MSE: 0.2103, Train MAE: 0.3146
Epoch: 067, Valid Loss: 0.3066, Valid MSE: 0.3745, Valid MAE: 0.4062
No update
aggregation weights dict_items([('client_7', 0.22723972126572858), ('client_8', 0.2475638159803476), ('client_1', 0.24997911943239876), ('client_5', 0.27521734332152514)])
Epoch: 068, Training Time: 35.3204 secs
Epoch: 068, Validation Time: 1.5333 secs
-----------------------
Epoch: 068, Train Loss: 0.1774, Train MSE: 0.2652, Train MAE: 0.3532
Epoch: 068, Valid Loss: 0.3070, Valid MSE: 0.3699, Valid MAE: 0.4036
No update
aggregation weights dict_items([('client_7', 0.25299740977128626), ('client_3', 0.22258425318101344), ('client_4', 0.26250252126006884), ('client_10', 0.2619158157876314)])
Epoch: 069, Training Time: 35.2720 secs
Epoch: 069, Validation Time: 1.6222 secs
-----------------------
Epoch: 069, Train Loss: 0.1566, Train MSE: 0.2254, Train MAE: 0.3239
Epoch: 069, Valid Loss: 0.3067, Valid MSE: 0.3695, Valid MAE: 0.4031
No update
aggregation weights dict_items([('client_10', 0.2732122187257102), ('client_5', 0.261764225546858), ('client_3', 0.20340931720049113), ('client_8', 0.26161423852694066)])
Epoch: 070, Training Time: 34.4183 secs
Epoch: 070, Validation Time: 1.6398 secs
-----------------------
Epoch: 070, Train Loss: 0.1616, Train MSE: 0.2428, Train MAE: 0.3357
Epoch: 070, Valid Loss: 0.3057, Valid MSE: 0.3717, Valid MAE: 0.4050
###Update tasks appear###
No update
aggregation weights dict_items([('client_8', 0.26455671274070697), ('client_5', 0.2445318063492969), ('client_6', 0.21897896342364392), ('client_7', 0.27193251748635217)])
Epoch: 071, Training Time: 35.5668 secs
Epoch: 071, Validation Time: 1.5321 secs
-----------------------
Epoch: 071, Train Loss: 0.1623, Train MSE: 0.2406, Train MAE: 0.3361
Epoch: 071, Valid Loss: 0.3162, Valid MSE: 0.3726, Valid MAE: 0.4056
No update
aggregation weights dict_items([('client_5', 0.2014032763427308), ('client_9', 0.2781931707092191), ('client_7', 0.25693614132168924), ('client_8', 0.2634674116263609)])
Epoch: 072, Training Time: 35.2972 secs
Epoch: 072, Validation Time: 1.6244 secs
-----------------------
Epoch: 072, Train Loss: 0.1775, Train MSE: 0.2722, Train MAE: 0.3553
Epoch: 072, Valid Loss: 0.3133, Valid MSE: 0.3722, Valid MAE: 0.4053
No update
aggregation weights dict_items([('client_8', 0.24738488071176065), ('client_3', 0.21523450984764775), ('client_4', 0.265743117356362), ('client_10', 0.2716374920842295)])
Epoch: 073, Training Time: 36.0194 secs
Epoch: 073, Validation Time: 1.6897 secs
-----------------------
Epoch: 073, Train Loss: 0.1667, Train MSE: 0.2503, Train MAE: 0.3386
Epoch: 073, Valid Loss: 0.3084, Valid MSE: 0.3686, Valid MAE: 0.4030
No update
aggregation weights dict_items([('client_8', 0.2669541031551881), ('client_7', 0.24855883218150146), ('client_4', 0.2348082440285787), ('client_5', 0.24967882063473176)])
Epoch: 074, Training Time: 35.7756 secs
Epoch: 074, Validation Time: 1.4753 secs
-----------------------
Epoch: 074, Train Loss: 0.1721, Train MSE: 0.2612, Train MAE: 0.3492
Epoch: 074, Valid Loss: 0.3126, Valid MSE: 0.3696, Valid MAE: 0.4039
No update
aggregation weights dict_items([('client_6', 0.23686167782774903), ('client_9', 0.27672638798874266), ('client_3', 0.21854991711257674), ('client_8', 0.26786201707093166)])
Epoch: 075, Training Time: 35.0254 secs
Epoch: 075, Validation Time: 1.5853 secs
-----------------------
Epoch: 075, Train Loss: 0.1603, Train MSE: 0.2403, Train MAE: 0.3324
Epoch: 075, Valid Loss: 0.3102, Valid MSE: 0.3717, Valid MAE: 0.4051
No update
aggregation weights dict_items([('client_9', 0.270624249975807), ('client_7', 0.23596696095029002), ('client_10', 0.27220970276454026), ('client_2', 0.22119908630936275)])
Epoch: 076, Training Time: 34.8708 secs
Epoch: 076, Validation Time: 1.5761 secs
-----------------------
Epoch: 076, Train Loss: 0.1706, Train MSE: 0.2462, Train MAE: 0.3384
Epoch: 076, Valid Loss: 0.3024, Valid MSE: 0.3705, Valid MAE: 0.4037
###Update tasks appear###
No update
aggregation weights dict_items([('client_3', 0.20761839084920897), ('client_2', 0.23770053613195224), ('client_4', 0.29347554315307717), ('client_7', 0.26120552986576173)])
Epoch: 077, Training Time: 35.7660 secs
Epoch: 077, Validation Time: 1.4870 secs
-----------------------
Epoch: 077, Train Loss: 0.1571, Train MSE: 0.2246, Train MAE: 0.3243
Epoch: 077, Valid Loss: 0.3036, Valid MSE: 0.3682, Valid MAE: 0.4021
###Update tasks appear###
No update
aggregation weights dict_items([('client_10', 0.2856546156990349), ('client_3', 0.2167516859077284), ('client_6', 0.23763121154152467), ('client_7', 0.259962486851712)])
Epoch: 078, Training Time: 34.7483 secs
Epoch: 078, Validation Time: 1.5722 secs
-----------------------
Epoch: 078, Train Loss: 0.1441, Train MSE: 0.2013, Train MAE: 0.3084
Epoch: 078, Valid Loss: 0.3048, Valid MSE: 0.3701, Valid MAE: 0.4029
###Update tasks appear###
No update
aggregation weights dict_items([('client_9', 0.282661395232631), ('client_2', 0.2263513748758623), ('client_1', 0.279843081275857), ('client_6', 0.21114414861564965)])
Epoch: 079, Training Time: 34.4172 secs
Epoch: 079, Validation Time: 1.4965 secs
-----------------------
Epoch: 079, Train Loss: 0.1671, Train MSE: 0.2331, Train MAE: 0.3308
Epoch: 079, Valid Loss: 0.3028, Valid MSE: 0.3701, Valid MAE: 0.4035
###Update tasks appear###
No update
aggregation weights dict_items([('client_3', 0.19915785830097898), ('client_5', 0.22429798356932815), ('client_9', 0.2993265146624794), ('client_7', 0.27721764346721345)])
Epoch: 080, Training Time: 34.5301 secs
Epoch: 080, Validation Time: 1.4613 secs
-----------------------
Epoch: 080, Train Loss: 0.1605, Train MSE: 0.2382, Train MAE: 0.3319
Epoch: 080, Valid Loss: 0.3072, Valid MSE: 0.3701, Valid MAE: 0.4032
No update
aggregation weights dict_items([('client_3', 0.21042206095589203), ('client_10', 0.27652737961462454), ('client_2', 0.25519665150088316), ('client_1', 0.25785390792860025)])
Epoch: 081, Training Time: 33.8217 secs
Epoch: 081, Validation Time: 2.2777 secs
-----------------------
Epoch: 081, Train Loss: 0.1612, Train MSE: 0.2231, Train MAE: 0.3248
Epoch: 081, Valid Loss: 0.3016, Valid MSE: 0.3689, Valid MAE: 0.4026
###Update tasks appear###
No update
aggregation weights dict_items([('client_7', 0.24524764102856222), ('client_1', 0.23953443818739978), ('client_9', 0.2881331694773766), ('client_6', 0.2270847513066614)])
Epoch: 082, Training Time: 34.8461 secs
Epoch: 082, Validation Time: 1.4694 secs
-----------------------
Epoch: 082, Train Loss: 0.1663, Train MSE: 0.2371, Train MAE: 0.3334
Epoch: 082, Valid Loss: 0.3031, Valid MSE: 0.3701, Valid MAE: 0.4032
###Update tasks appear###
No update
aggregation weights dict_items([('client_2', 0.21909811389404113), ('client_9', 0.261316494639109), ('client_4', 0.26731265407749194), ('client_7', 0.2522727373893579)])
Epoch: 083, Training Time: 33.7039 secs
Epoch: 083, Validation Time: 1.5221 secs
-----------------------
Epoch: 083, Train Loss: 0.1725, Train MSE: 0.2490, Train MAE: 0.3405
Epoch: 083, Valid Loss: 0.3041, Valid MSE: 0.3685, Valid MAE: 0.4019
###Update tasks appear###
No update
aggregation weights dict_items([('client_10', 0.2801040318320682), ('client_2', 0.24840369072973884), ('client_7', 0.24865015308744812), ('client_5', 0.2228421243507448)])
Epoch: 084, Training Time: 34.0800 secs
Epoch: 084, Validation Time: 2.2796 secs
-----------------------
Epoch: 084, Train Loss: 0.1623, Train MSE: 0.2299, Train MAE: 0.3297
Epoch: 084, Valid Loss: 0.3010, Valid MSE: 0.3696, Valid MAE: 0.4027
###Update tasks appear###
No update
aggregation weights dict_items([('client_7', 0.2541469698180838), ('client_3', 0.2104312902636465), ('client_4', 0.2783932806765901), ('client_2', 0.25702845924167955)])
Epoch: 085, Training Time: 34.4980 secs
Epoch: 085, Validation Time: 1.4626 secs
-----------------------
Epoch: 085, Train Loss: 0.1591, Train MSE: 0.2274, Train MAE: 0.3264
Epoch: 085, Valid Loss: 0.3038, Valid MSE: 0.3687, Valid MAE: 0.4020
###Update tasks appear###
No update
aggregation weights dict_items([('client_5', 0.25040525905147654), ('client_6', 0.23679516736753572), ('client_2', 0.22524556078459146), ('client_10', 0.28755401279639636)])
Epoch: 086, Training Time: 34.8511 secs
Epoch: 086, Validation Time: 1.4594 secs
-----------------------
Epoch: 086, Train Loss: 0.1545, Train MSE: 0.2136, Train MAE: 0.3191
Epoch: 086, Valid Loss: 0.3015, Valid MSE: 0.3704, Valid MAE: 0.4034
###Update tasks appear###
No update
aggregation weights dict_items([('client_5', 0.23240819796682965), ('client_8', 0.27873002882400766), ('client_6', 0.23590804966259157), ('client_1', 0.25295372354657114)])
Epoch: 087, Training Time: 35.3110 secs
Epoch: 087, Validation Time: 1.4666 secs
-----------------------
Epoch: 087, Train Loss: 0.1723, Train MSE: 0.2513, Train MAE: 0.3436
Epoch: 087, Valid Loss: 0.3031, Valid MSE: 0.3702, Valid MAE: 0.4038
###Update tasks appear###
No update
aggregation weights dict_items([('client_5', 0.2510559124389056), ('client_8', 0.24738110943238667), ('client_7', 0.23525492215341545), ('client_10', 0.2663080559752921)])
Epoch: 088, Training Time: 34.4044 secs
Epoch: 088, Validation Time: 1.3944 secs
-----------------------
Epoch: 088, Train Loss: 0.1740, Train MSE: 0.2607, Train MAE: 0.3487
Epoch: 088, Valid Loss: 0.3055, Valid MSE: 0.3701, Valid MAE: 0.4036
###Update tasks appear###
No update
aggregation weights dict_items([('client_4', 0.2829063890670662), ('client_9', 0.2714562579606054), ('client_2', 0.22138013618269428), ('client_6', 0.22425721678963403)])
Epoch: 089, Training Time: 33.8870 secs
Epoch: 089, Validation Time: 1.4067 secs
-----------------------
Epoch: 089, Train Loss: 0.1672, Train MSE: 0.2332, Train MAE: 0.3300
Epoch: 089, Valid Loss: 0.3054, Valid MSE: 0.3693, Valid MAE: 0.4030
###Update tasks appear###
No update
aggregation weights dict_items([('client_5', 0.26646059963290314), ('client_3', 0.1993885002201088), ('client_9', 0.2974990383076163), ('client_7', 0.23665186183937176)])
Epoch: 090, Training Time: 34.1800 secs
Epoch: 090, Validation Time: 2.3671 secs
-----------------------
Epoch: 090, Train Loss: 0.1632, Train MSE: 0.2418, Train MAE: 0.3352
Epoch: 090, Valid Loss: 0.3075, Valid MSE: 0.3699, Valid MAE: 0.4032
No update
aggregation weights dict_items([('client_7', 0.25256430951872266), ('client_6', 0.25895538210536034), ('client_5', 0.21633831319160343), ('client_9', 0.27214199518431365)])
Epoch: 091, Training Time: 33.9819 secs
Epoch: 091, Validation Time: 1.5288 secs
-----------------------
Epoch: 091, Train Loss: 0.1604, Train MSE: 0.2321, Train MAE: 0.3297
Epoch: 091, Valid Loss: 0.3092, Valid MSE: 0.3708, Valid MAE: 0.4040
No update
aggregation weights dict_items([('client_9', 0.24750518657344653), ('client_8', 0.24405589933401772), ('client_1', 0.2629839833729594), ('client_7', 0.24545493071957641)])
Epoch: 092, Training Time: 34.0589 secs
Epoch: 092, Validation Time: 1.5493 secs
-----------------------
Epoch: 092, Train Loss: 0.1924, Train MSE: 0.2814, Train MAE: 0.3614
Epoch: 092, Valid Loss: 0.3053, Valid MSE: 0.3702, Valid MAE: 0.4036
###Update tasks appear###
No update
aggregation weights dict_items([('client_3', 0.2153730204002306), ('client_4', 0.34223911019674624), ('client_7', 0.2191193202668603), ('client_1', 0.2232685491361628)])
Epoch: 093, Training Time: 33.6826 secs
Epoch: 093, Validation Time: 2.4525 secs
-----------------------
Epoch: 093, Train Loss: 0.1736, Train MSE: 0.2376, Train MAE: 0.3340
Epoch: 093, Valid Loss: 0.3070, Valid MSE: 0.3682, Valid MAE: 0.4022
No update
aggregation weights dict_items([('client_10', 0.327827019520617), ('client_3', 0.20539120996150056), ('client_5', 0.2685188473480165), ('client_7', 0.1982629231698659)])
Epoch: 094, Training Time: 34.4665 secs
Epoch: 094, Validation Time: 1.5246 secs
-----------------------
Epoch: 094, Train Loss: 0.1590, Train MSE: 0.2238, Train MAE: 0.3246
Epoch: 094, Valid Loss: 0.3050, Valid MSE: 0.3685, Valid MAE: 0.4022
###Update tasks appear###
No update
aggregation weights dict_items([('client_9', 0.2837878267250711), ('client_3', 0.19453388463919383), ('client_10', 0.34540380396261405), ('client_7', 0.17627448467312107)])
Epoch: 095, Training Time: 34.1523 secs
Epoch: 095, Validation Time: 1.4856 secs
-----------------------
Epoch: 095, Train Loss: 0.1666, Train MSE: 0.2376, Train MAE: 0.3317
Epoch: 095, Valid Loss: 0.3045, Valid MSE: 0.3689, Valid MAE: 0.4024
###Update tasks appear###
No update
aggregation weights dict_items([('client_1', 0.3053421880161556), ('client_9', 0.20666937351747944), ('client_3', 0.19132949264608615), ('client_4', 0.2966589458202789)])
Epoch: 096, Training Time: 34.3911 secs
Epoch: 096, Validation Time: 1.5291 secs
-----------------------
Epoch: 096, Train Loss: 0.1843, Train MSE: 0.2533, Train MAE: 0.3422
Epoch: 096, Valid Loss: 0.3046, Valid MSE: 0.3683, Valid MAE: 0.4020
###Update tasks appear###
No update
aggregation weights dict_items([('client_8', 0.1978512377397579), ('client_3', 0.24279695610322213), ('client_5', 0.2010252111647119), ('client_4', 0.3583265949923081)])
Epoch: 097, Training Time: 34.7002 secs
Epoch: 097, Validation Time: 1.5437 secs
-----------------------
Epoch: 097, Train Loss: 0.1761, Train MSE: 0.2602, Train MAE: 0.3469
Epoch: 097, Valid Loss: 0.3070, Valid MSE: 0.3681, Valid MAE: 0.4019
No update
aggregation weights dict_items([('client_5', 0.19676628371248372), ('client_8', 0.23999313508138834), ('client_9', 0.23932754882359578), ('client_1', 0.3239130323825321)])
Epoch: 098, Training Time: 33.9983 secs
Epoch: 098, Validation Time: 1.5115 secs
-----------------------
Epoch: 098, Train Loss: 0.1954, Train MSE: 0.2823, Train MAE: 0.3625
Epoch: 098, Valid Loss: 0.3057, Valid MSE: 0.3681, Valid MAE: 0.4020
###Update tasks appear###
No update
aggregation weights dict_items([('client_10', 0.3644456473070635), ('client_3', 0.1793253444928196), ('client_9', 0.21215145787017775), ('client_5', 0.2440775503299393)])
Epoch: 099, Training Time: 34.2832 secs
Epoch: 099, Validation Time: 1.5609 secs
-----------------------
Epoch: 099, Train Loss: 0.1670, Train MSE: 0.2368, Train MAE: 0.3319
Epoch: 099, Valid Loss: 0.3053, Valid MSE: 0.3681, Valid MAE: 0.4020
###Update tasks appear###
No update
aggregation weights dict_items([('client_7', 0.23151426161245925), ('client_3', 0.17317917509223515), ('client_9', 0.2287200574448632), ('client_10', 0.3665865058504424)])
Epoch: 100, Training Time: 34.3036 secs
Epoch: 100, Validation Time: 1.4333 secs
-----------------------
Epoch: 100, Train Loss: 0.1677, Train MSE: 0.2359, Train MAE: 0.3308
Epoch: 100, Valid Loss: 0.3052, Valid MSE: 0.3681, Valid MAE: 0.4020
###Update tasks appear###
No update
aggregation weights dict_items([('client_8', 0.16771922887991222), ('client_9', 0.24653665984538506), ('client_1', 0.3794962616685459), ('client_6', 0.20624784960615689)])
Epoch: 101, Training Time: 34.8513 secs
Epoch: 101, Validation Time: 1.4849 secs
-----------------------
Epoch: 101, Train Loss: 0.1884, Train MSE: 0.2629, Train MAE: 0.3494
Epoch: 101, Valid Loss: 0.3051, Valid MSE: 0.3681, Valid MAE: 0.4020
###Update tasks appear###
No update
aggregation weights dict_items([('client_10', 0.285430493325269), ('client_8', 0.2078297320091253), ('client_2', 0.2754321365126544), ('client_9', 0.23130763815295127)])
Epoch: 102, Training Time: 34.7312 secs
Epoch: 102, Validation Time: 1.4489 secs
-----------------------
Epoch: 102, Train Loss: 0.1915, Train MSE: 0.2702, Train MAE: 0.3530
Epoch: 102, Valid Loss: 0.3050, Valid MSE: 0.3682, Valid MAE: 0.4020
###Update tasks appear###
No update
aggregation weights dict_items([('client_6', 0.2572485060889841), ('client_3', 0.21362031471037488), ('client_5', 0.215631316883912), ('client_2', 0.3134998623167291)])
Epoch: 103, Training Time: 33.7251 secs
Epoch: 103, Validation Time: 1.4916 secs
-----------------------
Epoch: 103, Train Loss: 0.1549, Train MSE: 0.2077, Train MAE: 0.3145
Epoch: 103, Valid Loss: 0.3046, Valid MSE: 0.3682, Valid MAE: 0.4021
###Update tasks appear###
No update
aggregation weights dict_items([('client_8', 0.24784623323784674), ('client_7', 0.2697388398395273), ('client_5', 0.22995859674587377), ('client_6', 0.25245633017675223)])
Epoch: 104, Training Time: 34.0912 secs
Epoch: 104, Validation Time: 1.5186 secs
-----------------------
Epoch: 104, Train Loss: 0.1671, Train MSE: 0.2429, Train MAE: 0.3379
Epoch: 104, Valid Loss: 0.3051, Valid MSE: 0.3683, Valid MAE: 0.4021
###Update tasks appear###
No update
aggregation weights dict_items([('client_4', 0.3455360054222123), ('client_2', 0.2216725371332477), ('client_8', 0.2202677429187393), ('client_7', 0.21252371452580066)])
Epoch: 105, Training Time: 34.3157 secs
Epoch: 105, Validation Time: 1.4948 secs
-----------------------
Epoch: 105, Train Loss: 0.1878, Train MSE: 0.2643, Train MAE: 0.3513
Epoch: 105, Valid Loss: 0.3064, Valid MSE: 0.3682, Valid MAE: 0.4021
No update
aggregation weights dict_items([('client_2', 0.29001634397027304), ('client_6', 0.21180234977195803), ('client_3', 0.19228810332126772), ('client_1', 0.3058932029365012)])
Epoch: 106, Training Time: 34.6938 secs
Epoch: 106, Validation Time: 1.5686 secs
-----------------------
Epoch: 106, Train Loss: 0.1623, Train MSE: 0.2090, Train MAE: 0.3161
Epoch: 106, Valid Loss: 0.3030, Valid MSE: 0.3683, Valid MAE: 0.4021
###Update tasks appear###
No update
aggregation weights dict_items([('client_10', 0.2751005308395509), ('client_5', 0.19126043674880827), ('client_8', 0.2409458556860074), ('client_4', 0.2926931767256334)])
Epoch: 107, Training Time: 33.7117 secs
Epoch: 107, Validation Time: 1.5645 secs
-----------------------
Epoch: 107, Train Loss: 0.1859, Train MSE: 0.2720, Train MAE: 0.3545
Epoch: 107, Valid Loss: 0.3059, Valid MSE: 0.3680, Valid MAE: 0.4020
No update
aggregation weights dict_items([('client_3', 0.19649795784225166), ('client_10', 0.2374975867710113), ('client_6', 0.23480728736764325), ('client_4', 0.33119716801909377)])
Epoch: 108, Training Time: 34.6839 secs
Epoch: 108, Validation Time: 1.5305 secs
-----------------------
Epoch: 108, Train Loss: 0.1538, Train MSE: 0.2111, Train MAE: 0.3147
Epoch: 108, Valid Loss: 0.3079, Valid MSE: 0.3678, Valid MAE: 0.4018
No update
aggregation weights dict_items([('client_3', 0.2083046077535306), ('client_5', 0.22899369598450744), ('client_1', 0.30969175095480056), ('client_10', 0.25300994530716137)])
Epoch: 109, Training Time: 33.9915 secs
Epoch: 109, Validation Time: 1.4996 secs
-----------------------
Epoch: 109, Train Loss: 0.1661, Train MSE: 0.2311, Train MAE: 0.3300
Epoch: 109, Valid Loss: 0.3004, Valid MSE: 0.3679, Valid MAE: 0.4019
###Update tasks appear###
No update
aggregation weights dict_items([('client_6', 0.24563463406177585), ('client_1', 0.2856822268649366), ('client_5', 0.20582256393560977), ('client_7', 0.2628605751376778)])
Epoch: 110, Training Time: 34.3522 secs
Epoch: 110, Validation Time: 1.5720 secs
-----------------------
Epoch: 110, Train Loss: 0.1635, Train MSE: 0.2267, Train MAE: 0.3289
Epoch: 110, Valid Loss: 0.3022, Valid MSE: 0.3681, Valid MAE: 0.4020
###Update tasks appear###
No update
aggregation weights dict_items([('client_2', 0.22029471190830863), ('client_8', 0.23604393010673466), ('client_9', 0.2995358956707952), ('client_10', 0.24412546231416155)])
Epoch: 111, Training Time: 33.7658 secs
Epoch: 111, Validation Time: 1.4567 secs
-----------------------
Epoch: 111, Train Loss: 0.1825, Train MSE: 0.2679, Train MAE: 0.3517
Epoch: 111, Valid Loss: 0.3010, Valid MSE: 0.3694, Valid MAE: 0.4031
###Update tasks appear###
No update
Average Training Time: 34.6185 secs/epoch
Average Validation Time: 1.5773 secs
Training ends
The epoch of the best result: 61
The valid loss of the best model 0.3058
Test time (total): 8.1854 seconds
On average horizons, Test MSE: 0.2970, Test MAE: 0.3512
Total time spent: 4603.4192
