Namespace(device='cuda:0', root_path='./data/ETT-small', data_path='ETTh1', channel=48, num_nodes=7, seq_len=96, pred_len=24, batch_size=16, lrate=0.0001, dropout_n=0.8, d_llm=768, e_layer=2, head=4, model_path='./gpt2_model', tokenizer_path='./gpt2_tokenizer', weight_decay=0.001, feature_w=0.01, fcst_w=1, recon_w=0.5, att_w=0.01, num_workers=10, epochs=200, seed=6666, es_patience=50, save='./logs/2025-11-10-19:12:31-', num_users=10, frac=0.4, local_ep=5, all_clients=False, verbose=False, threshold=1, temperature=0.8, local_data_frac=0.8, vae_train_epochs=1, vae_local_epochs=10, shared_size=96)
The number of parameters: 1274640
Dual(
  (normalize_layers): Normalize()
  (length_to_feature): Linear(in_features=96, out_features=48, bias=True)
  (token_to_feature): Linear(in_features=768, out_features=48, bias=True)
  (ts_encoder): Encoder(
    (attn_layers): ModuleList(
      (0-1): 2 x EncoderLayer(
        (attention): AttentionLayer(
          (inner_attention): FullAttention(
            (dropout): Dropout(p=0.8, inplace=False)
          )
          (query_projection): Linear(in_features=48, out_features=48, bias=True)
          (key_projection): Linear(in_features=48, out_features=48, bias=True)
          (value_projection): Linear(in_features=48, out_features=48, bias=True)
          (out_projection): Linear(in_features=48, out_features=48, bias=True)
        )
        (conv1): Conv1d(48, 3072, kernel_size=(1,), stride=(1,))
        (conv2): Conv1d(3072, 48, kernel_size=(1,), stride=(1,))
        (norm1): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.8, inplace=False)
      )
    )
    (norm): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
  )
  (prompt_encoder): Encoder(
    (attn_layers): ModuleList(
      (0-1): 2 x EncoderLayer(
        (attention): AttentionLayer(
          (inner_attention): FullAttention(
            (dropout): Dropout(p=0.8, inplace=False)
          )
          (query_projection): Linear(in_features=48, out_features=48, bias=True)
          (key_projection): Linear(in_features=48, out_features=48, bias=True)
          (value_projection): Linear(in_features=48, out_features=48, bias=True)
          (out_projection): Linear(in_features=48, out_features=48, bias=True)
        )
        (conv1): Conv1d(48, 3072, kernel_size=(1,), stride=(1,))
        (conv2): Conv1d(3072, 48, kernel_size=(1,), stride=(1,))
        (norm1): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.8, inplace=False)
      )
    )
    (norm): LayerNorm((48,), eps=1e-05, elementwise_affine=True)
  )
  (ts_proj): Linear(in_features=48, out_features=24, bias=True)
  (prompt_proj): Linear(in_features=48, out_features=24, bias=True)
)
Start training...
Shared data Epoch [10/10],client_1  Loss: 2.2605
Shared data Epoch [10/10],client_2  Loss: 1.6775
Shared data Epoch [10/10],client_3  Loss: 1.9845
Shared data Epoch [10/10],client_4  Loss: 1.7633
Shared data Epoch [10/10],client_5  Loss: 2.0152
Shared data Epoch [10/10],client_6  Loss: 2.5672
Shared data Epoch [10/10],client_7  Loss: 2.2453
Shared data Epoch [10/10],client_8  Loss: 2.7270
Shared data Epoch [10/10],client_9  Loss: 2.4447
Shared data Epoch [10/10],client_10  Loss: 2.6939
Shared data shape: x torch.Size([10, 96, 7]), emb torch.Size([10, 96, 768])
aggregation weights dict_items([('client_1', 0.2509423153100483), ('client_4', 0.250370383729069), ('client_5', 0.24826996382194194), ('client_7', 0.2504173371389409)])
Epoch: 001, Training Time: 34.2256 secs
Epoch: 001, Validation Time: 1.3637 secs
-----------------------
Epoch: 001, Train Loss: 2.2712, Train MSE: 0.5558, Train MAE: 0.5431
Epoch: 001, Valid Loss: 0.7270, Valid MSE: 0.9718, Valid MAE: 0.6921
###Update tasks appear###
Updating! Valid Loss:0.7270, epoch:  1
aggregation weights dict_items([('client_8', 0.24835420634083483), ('client_1', 0.25142643511014134), ('client_4', 0.25221338706306257), ('client_6', 0.24800597148596118)])
Epoch: 002, Training Time: 36.1637 secs
Epoch: 002, Validation Time: 1.2972 secs
-----------------------
Epoch: 002, Train Loss: 1.2570, Train MSE: 0.5418, Train MAE: 0.5234
Epoch: 002, Valid Loss: 0.7263, Valid MSE: 0.9678, Valid MAE: 0.6898
###Update tasks appear###
Updating! Valid Loss:0.7263, epoch:  2
aggregation weights dict_items([('client_2', 0.25428635605911337), ('client_7', 0.25238645231585616), ('client_10', 0.23782874140574023), ('client_8', 0.25549845021929035)])
Epoch: 003, Training Time: 34.0023 secs
Epoch: 003, Validation Time: 1.3417 secs
-----------------------
Epoch: 003, Train Loss: 1.2945, Train MSE: 0.6014, Train MAE: 0.5490
Epoch: 003, Valid Loss: 0.7263, Valid MSE: 1.0478, Valid MAE: 0.7197
###Update tasks appear###
Updating! Valid Loss:0.7263, epoch:  3
aggregation weights dict_items([('client_5', 0.24741386559838272), ('client_3', 0.24993136563820995), ('client_4', 0.2517126089974599), ('client_6', 0.2509421597659474)])
Epoch: 004, Training Time: 34.4024 secs
Epoch: 004, Validation Time: 1.3771 secs
-----------------------
Epoch: 004, Train Loss: 1.4145, Train MSE: 0.5058, Train MAE: 0.5171
Epoch: 004, Valid Loss: 0.7985, Valid MSE: 1.2787, Valid MAE: 0.7950
No update
aggregation weights dict_items([('client_10', 0.24671005990857325), ('client_5', 0.24846518585499577), ('client_1', 0.2516082778287352), ('client_3', 0.25321647640769585)])
Epoch: 005, Training Time: 34.0767 secs
Epoch: 005, Validation Time: 1.4152 secs
-----------------------
Epoch: 005, Train Loss: 1.7545, Train MSE: 0.6027, Train MAE: 0.5597
Epoch: 005, Valid Loss: 0.8580, Valid MSE: 1.4533, Valid MAE: 0.8473
No update
aggregation weights dict_items([('client_1', 0.2494402823338192), ('client_7', 0.2499237860742075), ('client_10', 0.2503572150378172), ('client_2', 0.25027871655415607)])
Epoch: 006, Training Time: 34.1214 secs
Epoch: 006, Validation Time: 1.4241 secs
-----------------------
Epoch: 006, Train Loss: 2.0071, Train MSE: 0.6789, Train MAE: 0.5882
Epoch: 006, Valid Loss: 0.8945, Valid MSE: 1.5325, Valid MAE: 0.8708
No update
aggregation weights dict_items([('client_3', 0.25304179425423906), ('client_1', 0.24503951272654595), ('client_4', 0.24964973519767544), ('client_8', 0.2522689578215396)])
Epoch: 007, Training Time: 33.8764 secs
Epoch: 007, Validation Time: 1.4385 secs
-----------------------
Epoch: 007, Train Loss: 1.9673, Train MSE: 0.7747, Train MAE: 0.6295
Epoch: 007, Valid Loss: 0.8638, Valid MSE: 1.5455, Valid MAE: 0.8756
No update
aggregation weights dict_items([('client_7', 0.253689417637832), ('client_5', 0.24467565590884807), ('client_9', 0.24849060862676095), ('client_2', 0.2531443178265589)])
Epoch: 008, Training Time: 34.4624 secs
Epoch: 008, Validation Time: 1.3679 secs
-----------------------
Epoch: 008, Train Loss: 1.6301, Train MSE: 0.9096, Train MAE: 0.6705
Epoch: 008, Valid Loss: 0.8349, Valid MSE: 1.5062, Valid MAE: 0.8647
No update
aggregation weights dict_items([('client_6', 0.2523927578859139), ('client_8', 0.2511727808695292), ('client_3', 0.2518173753607041), ('client_2', 0.2446170858838528)])
Epoch: 009, Training Time: 33.9987 secs
Epoch: 009, Validation Time: 1.3901 secs
-----------------------
Epoch: 009, Train Loss: 1.1062, Train MSE: 0.7846, Train MAE: 0.6234
Epoch: 009, Valid Loss: 0.8242, Valid MSE: 1.4180, Valid MAE: 0.8406
No update
aggregation weights dict_items([('client_5', 0.24678280571183933), ('client_9', 0.2506195336726235), ('client_8', 0.2511692280570332), ('client_3', 0.251428432558504)])
Epoch: 010, Training Time: 34.2524 secs
Epoch: 010, Validation Time: 1.4001 secs
-----------------------
Epoch: 010, Train Loss: 0.8745, Train MSE: 0.9914, Train MAE: 0.6970
Epoch: 010, Valid Loss: 0.7275, Valid MSE: 1.1929, Valid MAE: 0.7714
No update
aggregation weights dict_items([('client_6', 0.2503690357361992), ('client_4', 0.2426459733648942), ('client_3', 0.2583275461486834), ('client_2', 0.24865744475022306)])
Epoch: 011, Training Time: 34.4560 secs
Epoch: 011, Validation Time: 1.3738 secs
-----------------------
Epoch: 011, Train Loss: 0.6166, Train MSE: 0.6512, Train MAE: 0.5729
Epoch: 011, Valid Loss: 0.7338, Valid MSE: 1.0682, Valid MAE: 0.7310
No update
aggregation weights dict_items([('client_5', 0.25487186700935327), ('client_1', 0.2500610088996246), ('client_2', 0.24900093483169258), ('client_4', 0.24606618925932952)])
Epoch: 012, Training Time: 34.7301 secs
Epoch: 012, Validation Time: 1.4396 secs
-----------------------
Epoch: 012, Train Loss: 0.5692, Train MSE: 0.6904, Train MAE: 0.5892
Epoch: 012, Valid Loss: 0.7351, Valid MSE: 0.9606, Valid MAE: 0.6938
No update
aggregation weights dict_items([('client_10', 0.26689279012764194), ('client_6', 0.2247511286817014), ('client_1', 0.24295043407233452), ('client_3', 0.26540564711832204)])
Epoch: 013, Training Time: 34.6285 secs
Epoch: 013, Validation Time: 1.4562 secs
-----------------------
Epoch: 013, Train Loss: 0.4948, Train MSE: 0.5977, Train MAE: 0.5457
Epoch: 013, Valid Loss: 0.6510, Valid MSE: 0.8677, Valid MAE: 0.6587
###Update tasks appear###
Test low! Updating! Test MSE: 0.7240, Test MAE: 0.5780, Test low! Updating! Valid Loss: 0.6510, epoch:  13
aggregation weights dict_items([('client_2', 0.22880107115786613), ('client_1', 0.3047910868654208), ('client_8', 0.23385044051365694), ('client_6', 0.23255740146305623)])
Epoch: 014, Training Time: 35.8976 secs
Epoch: 014, Validation Time: 1.4451 secs
-----------------------
Epoch: 014, Train Loss: 0.4660, Train MSE: 0.6015, Train MAE: 0.5435
Epoch: 014, Valid Loss: 0.6586, Valid MSE: 0.8006, Valid MAE: 0.6319
No update
aggregation weights dict_items([('client_9', 0.2594280582366853), ('client_1', 0.24985888987719804), ('client_5', 0.22418121869136823), ('client_6', 0.26653183319474844)])
Epoch: 015, Training Time: 34.8613 secs
Epoch: 015, Validation Time: 1.4072 secs
-----------------------
Epoch: 015, Train Loss: 0.4586, Train MSE: 0.6257, Train MAE: 0.5530
Epoch: 015, Valid Loss: 0.6118, Valid MSE: 0.7800, Valid MAE: 0.6235
###Update tasks appear###
Test low! Updating! Test MSE: 0.6395, Test MAE: 0.5434, Test low! Updating! Valid Loss: 0.6118, epoch:  15
aggregation weights dict_items([('client_5', 0.22648297133803716), ('client_10', 0.2234711648571095), ('client_7', 0.24346232709174787), ('client_4', 0.3065835367131056)])
Epoch: 016, Training Time: 34.4846 secs
Epoch: 016, Validation Time: 1.3966 secs
-----------------------
Epoch: 016, Train Loss: 0.4523, Train MSE: 0.6227, Train MAE: 0.5610
Epoch: 016, Valid Loss: 0.5957, Valid MSE: 0.7455, Valid MAE: 0.6075
###Update tasks appear###
Test low! Updating! Test MSE: 0.6093, Test MAE: 0.5296, Test low! Updating! Valid Loss: 0.5957, epoch:  16
aggregation weights dict_items([('client_4', 0.23728534633374332), ('client_2', 0.24566470961259987), ('client_1', 0.2918303085759711), ('client_5', 0.22521963547768564)])
Epoch: 017, Training Time: 34.1227 secs
Epoch: 017, Validation Time: 1.4607 secs
-----------------------
Epoch: 017, Train Loss: 0.3939, Train MSE: 0.5155, Train MAE: 0.5134
Epoch: 017, Valid Loss: 0.6367, Valid MSE: 0.7456, Valid MAE: 0.6096
No update
aggregation weights dict_items([('client_5', 0.2146016165593691), ('client_8', 0.25498465072513316), ('client_9', 0.26679085177120687), ('client_7', 0.2636228809442908)])
Epoch: 018, Training Time: 34.2014 secs
Epoch: 018, Validation Time: 1.3850 secs
-----------------------
Epoch: 018, Train Loss: 0.4511, Train MSE: 0.6719, Train MAE: 0.5755
Epoch: 018, Valid Loss: 0.5555, Valid MSE: 0.7093, Valid MAE: 0.5920
###Update tasks appear###
Test low! Updating! Test MSE: 0.5703, Test MAE: 0.5119, Test low! Updating! Valid Loss: 0.5555, epoch:  18
aggregation weights dict_items([('client_1', 0.2660031171248843), ('client_10', 0.2607702234224209), ('client_2', 0.23270056477184237), ('client_5', 0.24052609468085234)])
Epoch: 019, Training Time: 31.4778 secs
Epoch: 019, Validation Time: 1.4200 secs
-----------------------
Epoch: 019, Train Loss: 0.3658, Train MSE: 0.4779, Train MAE: 0.4929
Epoch: 019, Valid Loss: 0.5866, Valid MSE: 0.7069, Valid MAE: 0.5921
No update
aggregation weights dict_items([('client_7', 0.25576440538937123), ('client_4', 0.2378060038933285), ('client_8', 0.24744257575182738), ('client_2', 0.2589870149654729)])
Epoch: 020, Training Time: 36.7525 secs
Epoch: 020, Validation Time: 1.5489 secs
-----------------------
Epoch: 020, Train Loss: 0.3770, Train MSE: 0.5259, Train MAE: 0.5133
Epoch: 020, Valid Loss: 0.5534, Valid MSE: 0.7103, Valid MAE: 0.5929
###Update tasks appear###
Test low! Updating! Test MSE: 0.5642, Test MAE: 0.5081, Test low! Updating! Valid Loss: 0.5534, epoch:  20
aggregation weights dict_items([('client_9', 0.28563263288657925), ('client_1', 0.22894093060798273), ('client_10', 0.26053112590354705), ('client_2', 0.22489531060189094)])
Epoch: 021, Training Time: 35.4414 secs
Epoch: 021, Validation Time: 4.3385 secs
-----------------------
Epoch: 021, Train Loss: 0.3630, Train MSE: 0.5028, Train MAE: 0.4973
Epoch: 021, Valid Loss: 0.5569, Valid MSE: 0.6920, Valid MAE: 0.5838
No update
aggregation weights dict_items([('client_8', 0.29714220283454457), ('client_6', 0.22887080959610315), ('client_4', 0.2517211921041382), ('client_1', 0.22226579546521405)])
Epoch: 022, Training Time: 31.8123 secs
Epoch: 022, Validation Time: 1.4451 secs
-----------------------
Epoch: 022, Train Loss: 0.3381, Train MSE: 0.4641, Train MAE: 0.4798
Epoch: 022, Valid Loss: 0.5362, Valid MSE: 0.6834, Valid MAE: 0.5798
###Update tasks appear###
Test low! Updating! Test MSE: 0.5417, Test MAE: 0.4964, Test low! Updating! Valid Loss: 0.5362, epoch:  22
aggregation weights dict_items([('client_10', 0.29321624126922474), ('client_7', 0.2403492395590973), ('client_8', 0.2537592529227103), ('client_3', 0.21267526624896765)])
Epoch: 023, Training Time: 36.5500 secs
Epoch: 023, Validation Time: 1.4756 secs
-----------------------
Epoch: 023, Train Loss: 0.3464, Train MSE: 0.4892, Train MAE: 0.4927
Epoch: 023, Valid Loss: 0.5020, Valid MSE: 0.6425, Valid MAE: 0.5611
###Update tasks appear###
Test low! Updating! Test MSE: 0.5071, Test MAE: 0.4818, Test low! Updating! Valid Loss: 0.5020, epoch:  23
aggregation weights dict_items([('client_7', 0.28066786320849835), ('client_1', 0.21691943889111873), ('client_10', 0.2720493278949187), ('client_3', 0.23036337000546422)])
Epoch: 024, Training Time: 35.5170 secs
Epoch: 024, Validation Time: 1.4455 secs
-----------------------
Epoch: 024, Train Loss: 0.3178, Train MSE: 0.4233, Train MAE: 0.4641
Epoch: 024, Valid Loss: 0.5086, Valid MSE: 0.6493, Valid MAE: 0.5647
No update
aggregation weights dict_items([('client_6', 0.21498543802595013), ('client_1', 0.25338681510168554), ('client_7', 0.2765592698291481), ('client_10', 0.25506847704321617)])
Epoch: 025, Training Time: 34.8002 secs
Epoch: 025, Validation Time: 1.3954 secs
-----------------------
Epoch: 025, Train Loss: 0.3051, Train MSE: 0.4014, Train MAE: 0.4499
Epoch: 025, Valid Loss: 0.5031, Valid MSE: 0.6285, Valid MAE: 0.5547
No update
aggregation weights dict_items([('client_6', 0.22657713617026606), ('client_8', 0.26967936177232726), ('client_3', 0.2343256113414088), ('client_7', 0.26941789071599787)])
Epoch: 026, Training Time: 35.2781 secs
Epoch: 026, Validation Time: 1.3719 secs
-----------------------
Epoch: 026, Train Loss: 0.3031, Train MSE: 0.4174, Train MAE: 0.4540
Epoch: 026, Valid Loss: 0.4971, Valid MSE: 0.6149, Valid MAE: 0.5482
###Update tasks appear###
Test low! Updating! Test MSE: 0.4906, Test MAE: 0.4752, Test low! Updating! Valid Loss: 0.4971, epoch:  26
aggregation weights dict_items([('client_10', 0.2867460609135912), ('client_3', 0.22063436546972157), ('client_2', 0.27008768835706976), ('client_6', 0.22253188525961748)])
Epoch: 027, Training Time: 35.0523 secs
Epoch: 027, Validation Time: 1.4014 secs
-----------------------
Epoch: 027, Train Loss: 0.2719, Train MSE: 0.3427, Train MAE: 0.4175
Epoch: 027, Valid Loss: 0.4987, Valid MSE: 0.6165, Valid MAE: 0.5501
No update
aggregation weights dict_items([('client_8', 0.22868206923183992), ('client_9', 0.2789089737787733), ('client_3', 0.23117833331434104), ('client_4', 0.26123062367504574)])
Epoch: 028, Training Time: 35.4959 secs
Epoch: 028, Validation Time: 1.4364 secs
-----------------------
Epoch: 028, Train Loss: 0.3311, Train MSE: 0.4849, Train MAE: 0.4875
Epoch: 028, Valid Loss: 0.4756, Valid MSE: 0.5878, Valid MAE: 0.5347
###Update tasks appear###
Test low! Updating! Test MSE: 0.4767, Test MAE: 0.4683, Test low! Updating! Valid Loss: 0.4756, epoch:  28
aggregation weights dict_items([('client_10', 0.2926944151705749), ('client_2', 0.22046274152496792), ('client_4', 0.2578696753540013), ('client_3', 0.22897316795045586)])
Epoch: 029, Training Time: 35.5441 secs
Epoch: 029, Validation Time: 1.4633 secs
-----------------------
Epoch: 029, Train Loss: 0.2832, Train MSE: 0.3778, Train MAE: 0.4378
Epoch: 029, Valid Loss: 0.4872, Valid MSE: 0.5902, Valid MAE: 0.5376
No update
aggregation weights dict_items([('client_2', 0.20367344454078798), ('client_8', 0.28259841257313784), ('client_10', 0.23360191696858998), ('client_9', 0.28012622591748426)])
Epoch: 030, Training Time: 35.9595 secs
Epoch: 030, Validation Time: 1.4520 secs
-----------------------
Epoch: 030, Train Loss: 0.3189, Train MSE: 0.4581, Train MAE: 0.4723
Epoch: 030, Valid Loss: 0.4608, Valid MSE: 0.5703, Valid MAE: 0.5263
###Update tasks appear###
Test low! Updating! Test MSE: 0.4708, Test MAE: 0.4667, Test low! Updating! Valid Loss: 0.4608, epoch:  30
aggregation weights dict_items([('client_3', 0.23907403939095406), ('client_4', 0.25781409313679426), ('client_10', 0.2657043488200399), ('client_6', 0.23740751865221177)])
Epoch: 031, Training Time: 35.2729 secs
Epoch: 031, Validation Time: 1.3624 secs
-----------------------
Epoch: 031, Train Loss: 0.2671, Train MSE: 0.3526, Train MAE: 0.4218
Epoch: 031, Valid Loss: 0.4624, Valid MSE: 0.5532, Valid MAE: 0.5181
No update
aggregation weights dict_items([('client_8', 0.24126943726199454), ('client_9', 0.3527139956393912), ('client_2', 0.19978460268197307), ('client_3', 0.20623196441664116)])
Epoch: 032, Training Time: 34.9598 secs
Epoch: 032, Validation Time: 1.5620 secs
-----------------------
Epoch: 032, Train Loss: 0.2994, Train MSE: 0.4261, Train MAE: 0.4563
Epoch: 032, Valid Loss: 0.4509, Valid MSE: 0.5532, Valid MAE: 0.5176
###Update tasks appear###
Test low! Updating! Test MSE: 0.4578, Test MAE: 0.4592, Test low! Updating! Valid Loss: 0.4509, epoch:  32
aggregation weights dict_items([('client_9', 0.33390201730087554), ('client_6', 0.21091265356389718), ('client_10', 0.2428490477536667), ('client_3', 0.21233628138156038)])
Epoch: 033, Training Time: 34.6731 secs
Epoch: 033, Validation Time: 1.4534 secs
-----------------------
Epoch: 033, Train Loss: 0.2735, Train MSE: 0.3709, Train MAE: 0.4275
Epoch: 033, Valid Loss: 0.4447, Valid MSE: 0.5444, Valid MAE: 0.5128
###Update tasks appear###
Test low! Updating! Test MSE: 0.4554, Test MAE: 0.4598, Test low! Updating! Valid Loss: 0.4447, epoch:  33
aggregation weights dict_items([('client_1', 0.2516032880961067), ('client_4', 0.30056886762793655), ('client_5', 0.23308235710517955), ('client_6', 0.21474548717077713)])
Epoch: 034, Training Time: 35.4255 secs
Epoch: 034, Validation Time: 1.4091 secs
-----------------------
Epoch: 034, Train Loss: 0.2762, Train MSE: 0.3656, Train MAE: 0.4295
Epoch: 034, Valid Loss: 0.4494, Valid MSE: 0.5209, Valid MAE: 0.5009
No update
aggregation weights dict_items([('client_9', 0.3307969783050611), ('client_2', 0.21002497445858204), ('client_3', 0.20616787790409602), ('client_10', 0.2530101693322608)])
Epoch: 035, Training Time: 35.6086 secs
Epoch: 035, Validation Time: 1.4060 secs
-----------------------
Epoch: 035, Train Loss: 0.2749, Train MSE: 0.3730, Train MAE: 0.4305
Epoch: 035, Valid Loss: 0.4352, Valid MSE: 0.5181, Valid MAE: 0.4993
###Update tasks appear###
Test low! Updating! Test MSE: 0.4418, Test MAE: 0.4510, Test low! Updating! Valid Loss: 0.4352, epoch:  35
aggregation weights dict_items([('client_2', 0.21933550527578607), ('client_5', 0.2338548339769474), ('client_10', 0.26560112510728634), ('client_8', 0.28120853563998016)])
Epoch: 036, Training Time: 35.8974 secs
Epoch: 036, Validation Time: 1.4039 secs
-----------------------
Epoch: 036, Train Loss: 0.2840, Train MSE: 0.3976, Train MAE: 0.4435
Epoch: 036, Valid Loss: 0.4252, Valid MSE: 0.5044, Valid MAE: 0.4916
###Update tasks appear###
Test low! Updating! Test MSE: 0.4322, Test MAE: 0.4451, Test low! Updating! Valid Loss: 0.4252, epoch:  36
aggregation weights dict_items([('client_8', 0.2584970738360293), ('client_3', 0.20912531453741215), ('client_5', 0.24391435658475727), ('client_9', 0.2884632550418013)])
Epoch: 037, Training Time: 35.0067 secs
Epoch: 037, Validation Time: 1.4830 secs
-----------------------
Epoch: 037, Train Loss: 0.2923, Train MSE: 0.4242, Train MAE: 0.4562
Epoch: 037, Valid Loss: 0.4233, Valid MSE: 0.4951, Valid MAE: 0.4862
###Update tasks appear###
Test low! Updating! Test MSE: 0.4278, Test MAE: 0.4429, Test low! Updating! Valid Loss: 0.4233, epoch:  37
aggregation weights dict_items([('client_4', 0.2518761789384609), ('client_2', 0.21242862187814837), ('client_8', 0.2498926555784888), ('client_5', 0.28580254360490187)])
Epoch: 038, Training Time: 35.1773 secs
Epoch: 038, Validation Time: 1.4294 secs
-----------------------
Epoch: 038, Train Loss: 0.2815, Train MSE: 0.3968, Train MAE: 0.4442
Epoch: 038, Valid Loss: 0.4194, Valid MSE: 0.4843, Valid MAE: 0.4808
###Update tasks appear###
Test low! Updating! Test MSE: 0.4212, Test MAE: 0.4377, Test low! Updating! Valid Loss: 0.4194, epoch:  38
aggregation weights dict_items([('client_7', 0.28039021472036785), ('client_4', 0.215488624858984), ('client_8', 0.3069216289293783), ('client_3', 0.19719953149126984)])
Epoch: 039, Training Time: 37.9658 secs
Epoch: 039, Validation Time: 1.4385 secs
-----------------------
Epoch: 039, Train Loss: 0.2744, Train MSE: 0.3869, Train MAE: 0.4385
Epoch: 039, Valid Loss: 0.4241, Valid MSE: 0.4801, Valid MAE: 0.4781
No update
aggregation weights dict_items([('client_5', 0.22959409334563813), ('client_8', 0.2591917488779675), ('client_3', 0.22183846831555426), ('client_9', 0.28937568946084014)])
Epoch: 040, Training Time: 33.8419 secs
Epoch: 040, Validation Time: 1.3978 secs
-----------------------
Epoch: 040, Train Loss: 0.2808, Train MSE: 0.4051, Train MAE: 0.4463
Epoch: 040, Valid Loss: 0.4108, Valid MSE: 0.4747, Valid MAE: 0.4745
###Update tasks appear###
Test low! Updating! Test MSE: 0.4138, Test MAE: 0.4349, Test low! Updating! Valid Loss: 0.4108, epoch:  40
aggregation weights dict_items([('client_3', 0.2120733627186725), ('client_4', 0.22404278969332925), ('client_7', 0.23153813254181912), ('client_10', 0.3323457150461792)])
Epoch: 041, Training Time: 35.1238 secs
Epoch: 041, Validation Time: 1.3522 secs
-----------------------
Epoch: 041, Train Loss: 0.2566, Train MSE: 0.3464, Train MAE: 0.4171
Epoch: 041, Valid Loss: 0.4126, Valid MSE: 0.4713, Valid MAE: 0.4729
No update
aggregation weights dict_items([('client_5', 0.23271274780749082), ('client_2', 0.22045783560179016), ('client_4', 0.3188578436232922), ('client_6', 0.22797157296742684)])
Epoch: 042, Training Time: 40.0055 secs
Epoch: 042, Validation Time: 1.4097 secs
-----------------------
Epoch: 042, Train Loss: 0.2446, Train MSE: 0.3215, Train MAE: 0.4008
Epoch: 042, Valid Loss: 0.4115, Valid MSE: 0.4629, Valid MAE: 0.4687
No update
aggregation weights dict_items([('client_4', 0.26525987562917064), ('client_2', 0.19187525459454963), ('client_5', 0.2740910467024831), ('client_7', 0.2687738230737968)])
Epoch: 043, Training Time: 36.1371 secs
Epoch: 043, Validation Time: 1.4749 secs
-----------------------
Epoch: 043, Train Loss: 0.2563, Train MSE: 0.3463, Train MAE: 0.4185
Epoch: 043, Valid Loss: 0.4124, Valid MSE: 0.4613, Valid MAE: 0.4680
No update
aggregation weights dict_items([('client_2', 0.21252570408550828), ('client_8', 0.30392484403453307), ('client_3', 0.2251386496220441), ('client_5', 0.25841080225791463)])
Epoch: 044, Training Time: 35.5829 secs
Epoch: 044, Validation Time: 1.4888 secs
-----------------------
Epoch: 044, Train Loss: 0.2509, Train MSE: 0.3474, Train MAE: 0.4141
Epoch: 044, Valid Loss: 0.4011, Valid MSE: 0.4559, Valid MAE: 0.4643
###Update tasks appear###
Test low! Updating! Test MSE: 0.3992, Test MAE: 0.4234, Test low! Updating! Valid Loss: 0.4011, epoch:  44
aggregation weights dict_items([('client_10', 0.27795044094733246), ('client_7', 0.2797221241853584), ('client_5', 0.2133992248900286), ('client_1', 0.2289282099772805)])
Epoch: 045, Training Time: 35.4899 secs
Epoch: 045, Validation Time: 1.5352 secs
-----------------------
Epoch: 045, Train Loss: 0.2575, Train MSE: 0.3411, Train MAE: 0.4139
Epoch: 045, Valid Loss: 0.3944, Valid MSE: 0.4485, Valid MAE: 0.4593
###Update tasks appear###
Test low! Updating! Test MSE: 0.3987, Test MAE: 0.4248, Test low! Updating! Valid Loss: 0.3944, epoch:  45
aggregation weights dict_items([('client_10', 0.2263446003682667), ('client_3', 0.20617496829464405), ('client_1', 0.23276274446973436), ('client_9', 0.3347176868673549)])
Epoch: 046, Training Time: 35.0671 secs
Epoch: 046, Validation Time: 1.4516 secs
-----------------------
Epoch: 046, Train Loss: 0.2545, Train MSE: 0.3416, Train MAE: 0.4096
Epoch: 046, Valid Loss: 0.3911, Valid MSE: 0.4460, Valid MAE: 0.4568
###Update tasks appear###
Test low! Updating! Test MSE: 0.3939, Test MAE: 0.4218, Test low! Updating! Valid Loss: 0.3911, epoch:  46
aggregation weights dict_items([('client_7', 0.2446800037270549), ('client_10', 0.23372262072139008), ('client_5', 0.23941828908317295), ('client_8', 0.2821790864683821)])
Epoch: 047, Training Time: 35.3851 secs
Epoch: 047, Validation Time: 1.5196 secs
-----------------------
Epoch: 047, Train Loss: 0.2624, Train MSE: 0.3659, Train MAE: 0.4252
Epoch: 047, Valid Loss: 0.3953, Valid MSE: 0.4439, Valid MAE: 0.4550
No update
aggregation weights dict_items([('client_5', 0.23828453457831641), ('client_9', 0.30794575234876), ('client_6', 0.2010240521260449), ('client_7', 0.25274566094687867)])
Epoch: 048, Training Time: 35.4192 secs
Epoch: 048, Validation Time: 1.4613 secs
-----------------------
Epoch: 048, Train Loss: 0.2472, Train MSE: 0.3304, Train MAE: 0.4045
Epoch: 048, Valid Loss: 0.3965, Valid MSE: 0.4411, Valid MAE: 0.4522
No update
aggregation weights dict_items([('client_1', 0.23515495216235732), ('client_10', 0.2798877812219119), ('client_7', 0.24877775556263906), ('client_5', 0.2361795110530917)])
Epoch: 049, Training Time: 36.1870 secs
Epoch: 049, Validation Time: 1.5628 secs
-----------------------
Epoch: 049, Train Loss: 0.2486, Train MSE: 0.3271, Train MAE: 0.4039
Epoch: 049, Valid Loss: 0.3813, Valid MSE: 0.4348, Valid MAE: 0.4487
###Update tasks appear###
Test low! Updating! Test MSE: 0.3832, Test MAE: 0.4150, Test low! Updating! Valid Loss: 0.3813, epoch:  49
aggregation weights dict_items([('client_1', 0.20933636850872178), ('client_10', 0.25112391809520934), ('client_6', 0.1897307683770946), ('client_9', 0.3498089450189743)])
Epoch: 050, Training Time: 35.2380 secs
Epoch: 050, Validation Time: 1.4279 secs
-----------------------
Epoch: 050, Train Loss: 0.2406, Train MSE: 0.3147, Train MAE: 0.3921
Epoch: 050, Valid Loss: 0.3788, Valid MSE: 0.4348, Valid MAE: 0.4480
###Update tasks appear###
Test low! Updating! Test MSE: 0.3805, Test MAE: 0.4138, Test low! Updating! Valid Loss: 0.3788, epoch:  50
aggregation weights dict_items([('client_7', 0.2697964197787676), ('client_2', 0.20121297699843282), ('client_8', 0.2734330599460345), ('client_10', 0.25555754327676494)])
Epoch: 051, Training Time: 34.7546 secs
Epoch: 051, Validation Time: 1.4526 secs
-----------------------
Epoch: 051, Train Loss: 0.2479, Train MSE: 0.3366, Train MAE: 0.4061
Epoch: 051, Valid Loss: 0.3761, Valid MSE: 0.4355, Valid MAE: 0.4479
###Update tasks appear###
Test low! Updating! Test MSE: 0.3743, Test MAE: 0.4092, Test low! Updating! Valid Loss: 0.3761, epoch:  51
aggregation weights dict_items([('client_10', 0.26549818273645076), ('client_8', 0.2654548668837886), ('client_7', 0.2504631044438511), ('client_6', 0.2185838459359095)])
Epoch: 052, Training Time: 34.3935 secs
Epoch: 052, Validation Time: 1.4892 secs
-----------------------
Epoch: 052, Train Loss: 0.2342, Train MSE: 0.3155, Train MAE: 0.3925
Epoch: 052, Valid Loss: 0.3848, Valid MSE: 0.4345, Valid MAE: 0.4468
No update
aggregation weights dict_items([('client_3', 0.20800667497651937), ('client_4', 0.2424638717605971), ('client_9', 0.34420971333853684), ('client_6', 0.2053197399243467)])
Epoch: 053, Training Time: 34.4785 secs
Epoch: 053, Validation Time: 1.3747 secs
-----------------------
Epoch: 053, Train Loss: 0.2312, Train MSE: 0.3095, Train MAE: 0.3886
Epoch: 053, Valid Loss: 0.3830, Valid MSE: 0.4322, Valid MAE: 0.4454
No update
aggregation weights dict_items([('client_4', 0.2911874682040552), ('client_5', 0.2573546204018775), ('client_6', 0.22266654973343522), ('client_2', 0.22879136166063213)])
Epoch: 054, Training Time: 31.6558 secs
Epoch: 054, Validation Time: 1.5128 secs
-----------------------
Epoch: 054, Train Loss: 0.2264, Train MSE: 0.2979, Train MAE: 0.3832
Epoch: 054, Valid Loss: 0.3796, Valid MSE: 0.4241, Valid MAE: 0.4415
No update
aggregation weights dict_items([('client_6', 0.2460599061636712), ('client_4', 0.280204747933405), ('client_5', 0.2500459008225595), ('client_2', 0.22368944508036429)])
Epoch: 055, Training Time: 37.4100 secs
Epoch: 055, Validation Time: 1.7219 secs
-----------------------
Epoch: 055, Train Loss: 0.2225, Train MSE: 0.2954, Train MAE: 0.3822
Epoch: 055, Valid Loss: 0.3819, Valid MSE: 0.4231, Valid MAE: 0.4418
No update
aggregation weights dict_items([('client_3', 0.2517590685597567), ('client_5', 0.25170903975074066), ('client_2', 0.25053024570614785), ('client_6', 0.24600164598335478)])
Epoch: 056, Training Time: 33.6668 secs
Epoch: 056, Validation Time: 1.4085 secs
-----------------------
Epoch: 056, Train Loss: 0.2090, Train MSE: 0.2706, Train MAE: 0.3671
Epoch: 056, Valid Loss: 0.3788, Valid MSE: 0.4243, Valid MAE: 0.4422
No update
aggregation weights dict_items([('client_2', 0.19875142588440525), ('client_10', 0.247598676182851), ('client_9', 0.35475038465903036), ('client_3', 0.19889951327371333)])
Epoch: 057, Training Time: 31.2832 secs
Epoch: 057, Validation Time: 1.4255 secs
-----------------------
Epoch: 057, Train Loss: 0.2311, Train MSE: 0.3080, Train MAE: 0.3878
Epoch: 057, Valid Loss: 0.3708, Valid MSE: 0.4273, Valid MAE: 0.4426
###Update tasks appear###
Test low! Updating! Test MSE: 0.3666, Test MAE: 0.4021, Test low! Updating! Valid Loss: 0.3708, epoch:  57
aggregation weights dict_items([('client_2', 0.2437879609388953), ('client_5', 0.23385683571381805), ('client_3', 0.24063597376453655), ('client_10', 0.28171922958275003)])
Epoch: 058, Training Time: 37.1543 secs
Epoch: 058, Validation Time: 3.2320 secs
-----------------------
Epoch: 058, Train Loss: 0.2197, Train MSE: 0.2936, Train MAE: 0.3810
Epoch: 058, Valid Loss: 0.3710, Valid MSE: 0.4259, Valid MAE: 0.4425
No update
aggregation weights dict_items([('client_10', 0.2537032313792129), ('client_4', 0.22653665012830013), ('client_7', 0.250693516448797), ('client_9', 0.26906660204369)])
Epoch: 059, Training Time: 34.6361 secs
Epoch: 059, Validation Time: 1.4428 secs
-----------------------
Epoch: 059, Train Loss: 0.2466, Train MSE: 0.3383, Train MAE: 0.4068
Epoch: 059, Valid Loss: 0.3766, Valid MSE: 0.4294, Valid MAE: 0.4439
No update
aggregation weights dict_items([('client_8', 0.29217392563547984), ('client_4', 0.24031213581803348), ('client_1', 0.23942167044127227), ('client_3', 0.2280922681052144)])
Epoch: 060, Training Time: 33.9070 secs
Epoch: 060, Validation Time: 1.4440 secs
-----------------------
Epoch: 060, Train Loss: 0.2434, Train MSE: 0.3391, Train MAE: 0.4049
Epoch: 060, Valid Loss: 0.3681, Valid MSE: 0.4177, Valid MAE: 0.4373
###Update tasks appear###
Test low! Updating! Test MSE: 0.3613, Test MAE: 0.3995, Test low! Updating! Valid Loss: 0.3681, epoch:  60
aggregation weights dict_items([('client_9', 0.28546989139085055), ('client_8', 0.2619353140858825), ('client_7', 0.2503216192940716), ('client_2', 0.20227317522919533)])
Epoch: 061, Training Time: 34.3991 secs
Epoch: 061, Validation Time: 1.4597 secs
-----------------------
Epoch: 061, Train Loss: 0.2495, Train MSE: 0.3463, Train MAE: 0.4099
Epoch: 061, Valid Loss: 0.3671, Valid MSE: 0.4249, Valid MAE: 0.4407
###Update tasks appear###
No update
aggregation weights dict_items([('client_10', 0.2616985052239303), ('client_7', 0.2517044990630238), ('client_5', 0.28557665343718214), ('client_3', 0.20102034227586388)])
Epoch: 062, Training Time: 34.2251 secs
Epoch: 062, Validation Time: 1.4258 secs
-----------------------
Epoch: 062, Train Loss: 0.2206, Train MSE: 0.2959, Train MAE: 0.3818
Epoch: 062, Valid Loss: 0.3690, Valid MSE: 0.4222, Valid MAE: 0.4389
No update
aggregation weights dict_items([('client_4', 0.24394128468574403), ('client_2', 0.2282196032313723), ('client_1', 0.2606167834320967), ('client_7', 0.26722232865078693)])
Epoch: 063, Training Time: 34.4552 secs
Epoch: 063, Validation Time: 1.4261 secs
-----------------------
Epoch: 063, Train Loss: 0.2361, Train MSE: 0.3090, Train MAE: 0.3897
Epoch: 063, Valid Loss: 0.3663, Valid MSE: 0.4176, Valid MAE: 0.4368
###Update tasks appear###
No update
aggregation weights dict_items([('client_1', 0.24813969052735002), ('client_8', 0.2661833483074779), ('client_5', 0.23486781760838454), ('client_4', 0.2508091435567876)])
Epoch: 064, Training Time: 33.4574 secs
Epoch: 064, Validation Time: 1.4188 secs
-----------------------
Epoch: 064, Train Loss: 0.2488, Train MSE: 0.3536, Train MAE: 0.4148
Epoch: 064, Valid Loss: 0.3624, Valid MSE: 0.4132, Valid MAE: 0.4347
###Update tasks appear###
Test low! Updating! Test MSE: 0.3601, Test MAE: 0.3989, Test low! Updating! Valid Loss: 0.3624, epoch:  64
aggregation weights dict_items([('client_9', 0.29636705863066876), ('client_1', 0.24140782685387924), ('client_3', 0.2093877485719162), ('client_4', 0.2528373659435358)])
Epoch: 065, Training Time: 35.0502 secs
Epoch: 065, Validation Time: 1.5363 secs
-----------------------
Epoch: 065, Train Loss: 0.2353, Train MSE: 0.3218, Train MAE: 0.3957
Epoch: 065, Valid Loss: 0.3655, Valid MSE: 0.4153, Valid MAE: 0.4359
No update
aggregation weights dict_items([('client_9', 0.2799192719180072), ('client_4', 0.26343299735109643), ('client_3', 0.22037149935855263), ('client_7', 0.2362762313723436)])
Epoch: 066, Training Time: 34.5712 secs
Epoch: 066, Validation Time: 1.4235 secs
-----------------------
Epoch: 066, Train Loss: 0.2325, Train MSE: 0.3196, Train MAE: 0.3949
Epoch: 066, Valid Loss: 0.3752, Valid MSE: 0.4190, Valid MAE: 0.4375
No update
aggregation weights dict_items([('client_6', 0.2200996856883434), ('client_3', 0.214923159983689), ('client_9', 0.32564030882610034), ('client_2', 0.23933684550186718)])
Epoch: 067, Training Time: 34.1698 secs
Epoch: 067, Validation Time: 1.4052 secs
-----------------------
Epoch: 067, Train Loss: 0.2108, Train MSE: 0.2729, Train MAE: 0.3649
Epoch: 067, Valid Loss: 0.3643, Valid MSE: 0.4203, Valid MAE: 0.4380
No update
aggregation weights dict_items([('client_7', 0.2568517017517885), ('client_8', 0.25482153258149526), ('client_1', 0.23132441267574924), ('client_5', 0.257002352990967)])
Epoch: 068, Training Time: 31.1827 secs
Epoch: 068, Validation Time: 1.3641 secs
-----------------------
Epoch: 068, Train Loss: 0.2447, Train MSE: 0.3375, Train MAE: 0.4059
Epoch: 068, Valid Loss: 0.3649, Valid MSE: 0.4145, Valid MAE: 0.4344
No update
aggregation weights dict_items([('client_7', 0.24838791067843197), ('client_3', 0.2318355615443338), ('client_4', 0.25055792464073745), ('client_10', 0.26921860313649676)])
Epoch: 069, Training Time: 37.3662 secs
Epoch: 069, Validation Time: 1.5239 secs
-----------------------
Epoch: 069, Train Loss: 0.2213, Train MSE: 0.2957, Train MAE: 0.3801
Epoch: 069, Valid Loss: 0.3702, Valid MSE: 0.4189, Valid MAE: 0.4371
No update
aggregation weights dict_items([('client_10', 0.2485420513103245), ('client_5', 0.2650931591859888), ('client_3', 0.21637000741130705), ('client_8', 0.2699947820923796)])
Epoch: 070, Training Time: 33.8173 secs
Epoch: 070, Validation Time: 1.4419 secs
-----------------------
Epoch: 070, Train Loss: 0.2275, Train MSE: 0.3205, Train MAE: 0.3935
Epoch: 070, Valid Loss: 0.3635, Valid MSE: 0.4149, Valid MAE: 0.4346
No update
aggregation weights dict_items([('client_8', 0.2819477908094709), ('client_5', 0.23759351913215523), ('client_6', 0.2244032341290803), ('client_7', 0.25605545592929346)])
Epoch: 071, Training Time: 33.4589 secs
Epoch: 071, Validation Time: 1.4616 secs
-----------------------
Epoch: 071, Train Loss: 0.2252, Train MSE: 0.3103, Train MAE: 0.3875
Epoch: 071, Valid Loss: 0.3783, Valid MSE: 0.4146, Valid MAE: 0.4341
No update
aggregation weights dict_items([('client_5', 0.22512744041904953), ('client_9', 0.28111910875896595), ('client_7', 0.260569985361973), ('client_8', 0.23318346546001148)])
Epoch: 072, Training Time: 33.9080 secs
Epoch: 072, Validation Time: 1.3682 secs
-----------------------
Epoch: 072, Train Loss: 0.2455, Train MSE: 0.3503, Train MAE: 0.4126
Epoch: 072, Valid Loss: 0.3718, Valid MSE: 0.4159, Valid MAE: 0.4346
No update
aggregation weights dict_items([('client_8', 0.2691540580980827), ('client_3', 0.2195267059981193), ('client_4', 0.23506805110706325), ('client_10', 0.27625118479673477)])
Epoch: 073, Training Time: 34.3435 secs
Epoch: 073, Validation Time: 1.3938 secs
-----------------------
Epoch: 073, Train Loss: 0.2316, Train MSE: 0.3238, Train MAE: 0.3941
Epoch: 073, Valid Loss: 0.3648, Valid MSE: 0.4142, Valid MAE: 0.4337
No update
aggregation weights dict_items([('client_8', 0.27030983532607805), ('client_7', 0.24665106017312116), ('client_4', 0.2554555016455211), ('client_5', 0.22758360285527957)])
Epoch: 074, Training Time: 34.9639 secs
Epoch: 074, Validation Time: 1.4327 secs
-----------------------
Epoch: 074, Train Loss: 0.2393, Train MSE: 0.3418, Train MAE: 0.4077
Epoch: 074, Valid Loss: 0.3725, Valid MSE: 0.4132, Valid MAE: 0.4334
No update
aggregation weights dict_items([('client_6', 0.22544236247182287), ('client_9', 0.3148915300190474), ('client_3', 0.20559371293435827), ('client_8', 0.2540723945747714)])
Epoch: 075, Training Time: 34.9232 secs
Epoch: 075, Validation Time: 1.3771 secs
-----------------------
Epoch: 075, Train Loss: 0.2216, Train MSE: 0.3063, Train MAE: 0.3831
Epoch: 075, Valid Loss: 0.3643, Valid MSE: 0.4134, Valid MAE: 0.4331
No update
aggregation weights dict_items([('client_9', 0.2978199212159665), ('client_7', 0.2364737129629588), ('client_10', 0.2447697857987565), ('client_2', 0.2209365800223182)])
Epoch: 076, Training Time: 34.3513 secs
Epoch: 076, Validation Time: 1.4263 secs
-----------------------
Epoch: 076, Train Loss: 0.2324, Train MSE: 0.3051, Train MAE: 0.3848
Epoch: 076, Valid Loss: 0.3576, Valid MSE: 0.4156, Valid MAE: 0.4341
###Update tasks appear###
Test low! Updating! Test MSE: 0.3573, Test MAE: 0.3957, Test low! Updating! Valid Loss: 0.3576, epoch:  76
aggregation weights dict_items([('client_3', 0.23167664626295012), ('client_2', 0.24377234621696406), ('client_4', 0.24907046220914908), ('client_7', 0.2754805453109368)])
Epoch: 077, Training Time: 34.7783 secs
Epoch: 077, Validation Time: 1.4335 secs
-----------------------
Epoch: 077, Train Loss: 0.2191, Train MSE: 0.2888, Train MAE: 0.3756
Epoch: 077, Valid Loss: 0.3614, Valid MSE: 0.4154, Valid MAE: 0.4342
No update
aggregation weights dict_items([('client_10', 0.29350086528744285), ('client_3', 0.2242952874877146), ('client_6', 0.2319553348203294), ('client_7', 0.2502485124045133)])
Epoch: 078, Training Time: 34.8751 secs
Epoch: 078, Validation Time: 1.4359 secs
-----------------------
Epoch: 078, Train Loss: 0.2006, Train MSE: 0.2555, Train MAE: 0.3546
Epoch: 078, Valid Loss: 0.3627, Valid MSE: 0.4181, Valid MAE: 0.4355
No update
aggregation weights dict_items([('client_9', 0.30161102243959237), ('client_2', 0.21800311184132623), ('client_1', 0.2598356014633568), ('client_6', 0.22055026425572455)])
Epoch: 079, Training Time: 34.0854 secs
Epoch: 079, Validation Time: 1.4278 secs
-----------------------
Epoch: 079, Train Loss: 0.2283, Train MSE: 0.2868, Train MAE: 0.3728
Epoch: 079, Valid Loss: 0.3610, Valid MSE: 0.4140, Valid MAE: 0.4331
No update
aggregation weights dict_items([('client_3', 0.21672872110096886), ('client_5', 0.2628093531823305), ('client_9', 0.29431885936808383), ('client_7', 0.22614306634861678)])
Epoch: 080, Training Time: 34.6332 secs
Epoch: 080, Validation Time: 1.3979 secs
-----------------------
Epoch: 080, Train Loss: 0.2265, Train MSE: 0.3109, Train MAE: 0.3885
Epoch: 080, Valid Loss: 0.3626, Valid MSE: 0.4157, Valid MAE: 0.4341
No update
aggregation weights dict_items([('client_3', 0.2151702617113817), ('client_10', 0.2884632417398198), ('client_2', 0.23549513724021626), ('client_1', 0.2608713593085822)])
Epoch: 081, Training Time: 35.3162 secs
Epoch: 081, Validation Time: 1.5284 secs
-----------------------
Epoch: 081, Train Loss: 0.2217, Train MSE: 0.2782, Train MAE: 0.3682
Epoch: 081, Valid Loss: 0.3610, Valid MSE: 0.4128, Valid MAE: 0.4324
No update
aggregation weights dict_items([('client_7', 0.25560209220497704), ('client_1', 0.23102647483525407), ('client_9', 0.28458794991907), ('client_6', 0.22878348304069893)])
Epoch: 082, Training Time: 34.9221 secs
Epoch: 082, Validation Time: 1.3930 secs
-----------------------
Epoch: 082, Train Loss: 0.2276, Train MSE: 0.2929, Train MAE: 0.3773
Epoch: 082, Valid Loss: 0.3596, Valid MSE: 0.4146, Valid MAE: 0.4335
No update
aggregation weights dict_items([('client_2', 0.22759483581345016), ('client_9', 0.2772655754801823), ('client_4', 0.25601175940741216), ('client_7', 0.23912782929895537)])
Epoch: 083, Training Time: 34.1847 secs
Epoch: 083, Validation Time: 1.4786 secs
-----------------------
Epoch: 083, Train Loss: 0.2366, Train MSE: 0.3154, Train MAE: 0.3912
Epoch: 083, Valid Loss: 0.3628, Valid MSE: 0.4153, Valid MAE: 0.4339
No update
aggregation weights dict_items([('client_10', 0.24380250743156076), ('client_2', 0.23722688043714055), ('client_7', 0.236870874560177), ('client_5', 0.28209973757112167)])
Epoch: 084, Training Time: 34.3292 secs
Epoch: 084, Validation Time: 1.3998 secs
-----------------------
Epoch: 084, Train Loss: 0.2233, Train MSE: 0.2915, Train MAE: 0.3776
Epoch: 084, Valid Loss: 0.3572, Valid MSE: 0.4148, Valid MAE: 0.4335
###Update tasks appear###
No update
aggregation weights dict_items([('client_7', 0.26121002474207955), ('client_3', 0.2377435063013453), ('client_4', 0.26795854568792693), ('client_2', 0.23308792326864813)])
Epoch: 085, Training Time: 34.6679 secs
Epoch: 085, Validation Time: 4.3016 secs
-----------------------
Epoch: 085, Train Loss: 0.2212, Train MSE: 0.2914, Train MAE: 0.3768
Epoch: 085, Valid Loss: 0.3628, Valid MSE: 0.4154, Valid MAE: 0.4341
No update
aggregation weights dict_items([('client_5', 0.24277302544762316), ('client_6', 0.24674294574947295), ('client_2', 0.23343850262777283), ('client_10', 0.27704552617513095)])
Epoch: 086, Training Time: 31.1313 secs
Epoch: 086, Validation Time: 1.4908 secs
-----------------------
Epoch: 086, Train Loss: 0.2131, Train MSE: 0.2706, Train MAE: 0.3630
Epoch: 086, Valid Loss: 0.3568, Valid MSE: 0.4138, Valid MAE: 0.4330
###Update tasks appear###
Test low! Updating! Test MSE: 0.3564, Test MAE: 0.3947, Test low! Updating! Valid Loss: 0.3568, epoch:  86
aggregation weights dict_items([('client_5', 0.23463253286491098), ('client_8', 0.26404729335175864), ('client_6', 0.22046263276866668), ('client_1', 0.28085754101466365)])
Epoch: 087, Training Time: 35.5850 secs
Epoch: 087, Validation Time: 1.4470 secs
-----------------------
Epoch: 087, Train Loss: 0.2346, Train MSE: 0.3151, Train MAE: 0.3899
Epoch: 087, Valid Loss: 0.3582, Valid MSE: 0.4116, Valid MAE: 0.4318
No update
aggregation weights dict_items([('client_5', 0.23136498063019464), ('client_8', 0.2692253755532383), ('client_7', 0.2351626160663833), ('client_10', 0.2642470277501837)])
Epoch: 088, Training Time: 36.0958 secs
Epoch: 088, Validation Time: 1.4172 secs
-----------------------
Epoch: 088, Train Loss: 0.2363, Train MSE: 0.3286, Train MAE: 0.3988
Epoch: 088, Valid Loss: 0.3610, Valid MSE: 0.4125, Valid MAE: 0.4323
No update
aggregation weights dict_items([('client_4', 0.25984796899240725), ('client_9', 0.2630010265198851), ('client_2', 0.2432101530334946), ('client_6', 0.23394085145421298)])
Epoch: 089, Training Time: 32.4680 secs
Epoch: 089, Validation Time: 1.4298 secs
-----------------------
Epoch: 089, Train Loss: 0.2289, Train MSE: 0.2919, Train MAE: 0.3755
Epoch: 089, Valid Loss: 0.3612, Valid MSE: 0.4127, Valid MAE: 0.4324
No update
aggregation weights dict_items([('client_5', 0.25402495894963223), ('client_3', 0.20279225295453462), ('client_9', 0.3121092789641142), ('client_7', 0.2310735091317189)])
Epoch: 090, Training Time: 34.8355 secs
Epoch: 090, Validation Time: 1.4376 secs
-----------------------
Epoch: 090, Train Loss: 0.2275, Train MSE: 0.3110, Train MAE: 0.3890
Epoch: 090, Valid Loss: 0.3629, Valid MSE: 0.4136, Valid MAE: 0.4329
No update
aggregation weights dict_items([('client_7', 0.24300363710533648), ('client_6', 0.21100034928775915), ('client_5', 0.26481629903981124), ('client_9', 0.2811797145670931)])
Epoch: 091, Training Time: 34.5681 secs
Epoch: 091, Validation Time: 4.4292 secs
-----------------------
Epoch: 091, Train Loss: 0.2214, Train MSE: 0.2949, Train MAE: 0.3784
Epoch: 091, Valid Loss: 0.3650, Valid MSE: 0.4139, Valid MAE: 0.4331
No update
aggregation weights dict_items([('client_9', 0.26398049211769675), ('client_8', 0.2490048388367436), ('client_1', 0.2575709323803155), ('client_7', 0.22944373666524415)])
Epoch: 092, Training Time: 31.5859 secs
Epoch: 092, Validation Time: 4.3606 secs
-----------------------
Epoch: 092, Train Loss: 0.2565, Train MSE: 0.3446, Train MAE: 0.4082
Epoch: 092, Valid Loss: 0.3613, Valid MSE: 0.4134, Valid MAE: 0.4327
No update
aggregation weights dict_items([('client_3', 0.2156257060869113), ('client_4', 0.29646996206817644), ('client_7', 0.23951668955226435), ('client_1', 0.24838764229264784)])
Epoch: 093, Training Time: 35.1314 secs
Epoch: 093, Validation Time: 1.4166 secs
-----------------------
Epoch: 093, Train Loss: 0.2367, Train MSE: 0.2995, Train MAE: 0.3822
Epoch: 093, Valid Loss: 0.3628, Valid MSE: 0.4134, Valid MAE: 0.4327
No update
aggregation weights dict_items([('client_10', 0.30374075079160223), ('client_3', 0.22871630386625985), ('client_5', 0.21271015602066076), ('client_7', 0.2548327893214771)])
Epoch: 094, Training Time: 34.5136 secs
Epoch: 094, Validation Time: 1.4837 secs
-----------------------
Epoch: 094, Train Loss: 0.2195, Train MSE: 0.2868, Train MAE: 0.3743
Epoch: 094, Valid Loss: 0.3608, Valid MSE: 0.4139, Valid MAE: 0.4331
No update
aggregation weights dict_items([('client_9', 0.28813090177903156), ('client_3', 0.21317739281594253), ('client_10', 0.26781920780520607), ('client_7', 0.23087249759981973)])
Epoch: 095, Training Time: 34.6998 secs
Epoch: 095, Validation Time: 1.5763 secs
-----------------------
Epoch: 095, Train Loss: 0.2269, Train MSE: 0.2978, Train MAE: 0.3801
Epoch: 095, Valid Loss: 0.3605, Valid MSE: 0.4143, Valid MAE: 0.4333
No update
aggregation weights dict_items([('client_1', 0.2899735857564531), ('client_9', 0.26825391523967773), ('client_3', 0.20665904645080757), ('client_4', 0.2351134525530617)])
Epoch: 096, Training Time: 34.5724 secs
Epoch: 096, Validation Time: 1.4838 secs
-----------------------
Epoch: 096, Train Loss: 0.2496, Train MSE: 0.3198, Train MAE: 0.3927
Epoch: 096, Valid Loss: 0.3605, Valid MSE: 0.4142, Valid MAE: 0.4332
No update
aggregation weights dict_items([('client_8', 0.24898585700726483), ('client_3', 0.21314578518577582), ('client_5', 0.24185007772843928), ('client_4', 0.2960182800785201)])
Epoch: 097, Training Time: 34.6840 secs
Epoch: 097, Validation Time: 1.4897 secs
-----------------------
Epoch: 097, Train Loss: 0.2412, Train MSE: 0.3348, Train MAE: 0.4020
Epoch: 097, Valid Loss: 0.3618, Valid MSE: 0.4138, Valid MAE: 0.4330
No update
aggregation weights dict_items([('client_5', 0.2195971932222949), ('client_8', 0.23224198430913384), ('client_9', 0.2521439054232369), ('client_1', 0.29601691704533445)])
Epoch: 098, Training Time: 34.4665 secs
Epoch: 098, Validation Time: 1.4489 secs
-----------------------
Epoch: 098, Train Loss: 0.2602, Train MSE: 0.3515, Train MAE: 0.4119
Epoch: 098, Valid Loss: 0.3614, Valid MSE: 0.4137, Valid MAE: 0.4329
No update
aggregation weights dict_items([('client_10', 0.3040803533168911), ('client_3', 0.19512045278397439), ('client_9', 0.2828832228315189), ('client_5', 0.2179159710676156)])
Epoch: 099, Training Time: 31.8662 secs
Epoch: 099, Validation Time: 1.4025 secs
-----------------------
Epoch: 099, Train Loss: 0.2304, Train MSE: 0.3055, Train MAE: 0.3850
Epoch: 099, Valid Loss: 0.3611, Valid MSE: 0.4138, Valid MAE: 0.4330
No update
aggregation weights dict_items([('client_7', 0.23301115343094397), ('client_3', 0.2026032942343869), ('client_9', 0.2452545541786383), ('client_10', 0.3191309981560308)])
Epoch: 100, Training Time: 36.0069 secs
Epoch: 100, Validation Time: 1.4526 secs
-----------------------
Epoch: 100, Train Loss: 0.2283, Train MSE: 0.2964, Train MAE: 0.3790
Epoch: 100, Valid Loss: 0.3610, Valid MSE: 0.4138, Valid MAE: 0.4330
No update
aggregation weights dict_items([('client_8', 0.2586392043673356), ('client_9', 0.2576135826431923), ('client_1', 0.26748457434178996), ('client_6', 0.2162626386476822)])
Epoch: 101, Training Time: 34.8718 secs
Epoch: 101, Validation Time: 1.4313 secs
-----------------------
Epoch: 101, Train Loss: 0.2469, Train MSE: 0.3187, Train MAE: 0.3909
Epoch: 101, Valid Loss: 0.3610, Valid MSE: 0.4138, Valid MAE: 0.4330
No update
aggregation weights dict_items([('client_10', 0.2495845687736445), ('client_8', 0.23191540500894234), ('client_2', 0.27004474562973857), ('client_9', 0.24845528058767463)])
Epoch: 102, Training Time: 34.6864 secs
Epoch: 102, Validation Time: 1.5055 secs
-----------------------
Epoch: 102, Train Loss: 0.2544, Train MSE: 0.3306, Train MAE: 0.3979
Epoch: 102, Valid Loss: 0.3609, Valid MSE: 0.4138, Valid MAE: 0.4330
No update
aggregation weights dict_items([('client_6', 0.21625563019229802), ('client_3', 0.24106457638846485), ('client_5', 0.24793416055126222), ('client_2', 0.294745632867975)])
Epoch: 103, Training Time: 34.7989 secs
Epoch: 103, Validation Time: 1.4812 secs
-----------------------
Epoch: 103, Train Loss: 0.2156, Train MSE: 0.2644, Train MAE: 0.3592
Epoch: 103, Valid Loss: 0.3608, Valid MSE: 0.4138, Valid MAE: 0.4330
No update
aggregation weights dict_items([('client_8', 0.24452843346725084), ('client_7', 0.2517070380127027), ('client_5', 0.2636626819305199), ('client_6', 0.24010184658952652)])
Epoch: 104, Training Time: 34.9689 secs
Epoch: 104, Validation Time: 1.4334 secs
-----------------------
Epoch: 104, Train Loss: 0.2255, Train MSE: 0.3039, Train MAE: 0.3838
Epoch: 104, Valid Loss: 0.3614, Valid MSE: 0.4138, Valid MAE: 0.4330
No update
aggregation weights dict_items([('client_4', 0.2696498193223773), ('client_2', 0.26978577373087786), ('client_8', 0.225238510209946), ('client_7', 0.23532589673679882)])
Epoch: 105, Training Time: 34.5396 secs
Epoch: 105, Validation Time: 1.4187 secs
-----------------------
Epoch: 105, Train Loss: 0.2515, Train MSE: 0.3274, Train MAE: 0.3980
Epoch: 105, Valid Loss: 0.3624, Valid MSE: 0.4137, Valid MAE: 0.4330
No update
aggregation weights dict_items([('client_2', 0.2776071209080066), ('client_6', 0.2261875636491974), ('client_3', 0.2206914563029401), ('client_1', 0.27551385913985577)])
Epoch: 106, Training Time: 32.9085 secs
Epoch: 106, Validation Time: 1.5393 secs
-----------------------
Epoch: 106, Train Loss: 0.2235, Train MSE: 0.2571, Train MAE: 0.3548
Epoch: 106, Valid Loss: 0.3602, Valid MSE: 0.4135, Valid MAE: 0.4328
No update
aggregation weights dict_items([('client_10', 0.24638907157777654), ('client_5', 0.24516041332940527), ('client_8', 0.2656488517287274), ('client_4', 0.24280166336409084)])
Epoch: 107, Training Time: 36.4823 secs
Epoch: 107, Validation Time: 1.4686 secs
-----------------------
Epoch: 107, Train Loss: 0.2506, Train MSE: 0.3456, Train MAE: 0.4081
Epoch: 107, Valid Loss: 0.3609, Valid MSE: 0.4130, Valid MAE: 0.4326
No update
aggregation weights dict_items([('client_3', 0.21837783371756825), ('client_10', 0.29045928842986507), ('client_6', 0.21969714818717273), ('client_4', 0.2714657296653939)])
Epoch: 108, Training Time: 33.3643 secs
Epoch: 108, Validation Time: 1.4700 secs
-----------------------
Epoch: 108, Train Loss: 0.2126, Train MSE: 0.2684, Train MAE: 0.3611
Epoch: 108, Valid Loss: 0.3617, Valid MSE: 0.4135, Valid MAE: 0.4328
No update
aggregation weights dict_items([('client_3', 0.21847704998159212), ('client_5', 0.25021544767466836), ('client_1', 0.2722951548921178), ('client_10', 0.25901234745162177)])
Epoch: 109, Training Time: 34.3468 secs
Epoch: 109, Validation Time: 1.4864 secs
-----------------------
Epoch: 109, Train Loss: 0.2310, Train MSE: 0.2968, Train MAE: 0.3798
Epoch: 109, Valid Loss: 0.3566, Valid MSE: 0.4129, Valid MAE: 0.4325
###Update tasks appear###
No update
aggregation weights dict_items([('client_6', 0.2307284943592769), ('client_1', 0.26602047056862627), ('client_5', 0.2618330003110192), ('client_7', 0.24141803476107776)])
Epoch: 110, Training Time: 34.8806 secs
Epoch: 110, Validation Time: 1.4472 secs
-----------------------
Epoch: 110, Train Loss: 0.2251, Train MSE: 0.2846, Train MAE: 0.3730
Epoch: 110, Valid Loss: 0.3590, Valid MSE: 0.4130, Valid MAE: 0.4326
No update
aggregation weights dict_items([('client_2', 0.2287715612703385), ('client_8', 0.23744590975581806), ('client_9', 0.29807306499912634), ('client_10', 0.2357094639747171)])
Epoch: 111, Training Time: 34.6011 secs
Epoch: 111, Validation Time: 1.4345 secs
-----------------------
Epoch: 111, Train Loss: 0.2440, Train MSE: 0.3285, Train MAE: 0.3968
Epoch: 111, Valid Loss: 0.3567, Valid MSE: 0.4128, Valid MAE: 0.4324
###Update tasks appear###
No update
aggregation weights dict_items([('client_2', 0.23061347566226598), ('client_3', 0.2183706791760035), ('client_10', 0.285764139340228), ('client_1', 0.2652517058215026)])
Epoch: 112, Training Time: 34.1869 secs
Epoch: 112, Validation Time: 1.5637 secs
-----------------------
Epoch: 112, Train Loss: 0.2224, Train MSE: 0.2781, Train MAE: 0.3675
Epoch: 112, Valid Loss: 0.3555, Valid MSE: 0.4125, Valid MAE: 0.4322
###Update tasks appear###
Test low! Updating! Test MSE: 0.3564, Test MAE: 0.3948, Test low! Updating! Valid Loss: 0.3555, epoch:  112
aggregation weights dict_items([('client_8', 0.3090739147096989), ('client_2', 0.208001823221788), ('client_10', 0.26690584042259563), ('client_6', 0.21601842164591745)])
Epoch: 113, Training Time: 34.1766 secs
Epoch: 113, Validation Time: 1.4278 secs
-----------------------
Epoch: 113, Train Loss: 0.2188, Train MSE: 0.2845, Train MAE: 0.3708
Epoch: 113, Valid Loss: 0.3544, Valid MSE: 0.4120, Valid MAE: 0.4318
###Update tasks appear###
Test low! Updating! Test MSE: 0.3550, Test MAE: 0.3943, Test low! Updating! Valid Loss: 0.3544, epoch:  113
aggregation weights dict_items([('client_1', 0.257549470245348), ('client_5', 0.22060494861328214), ('client_9', 0.296220789616548), ('client_6', 0.2256247915248217)])
Epoch: 114, Training Time: 34.2489 secs
Epoch: 114, Validation Time: 1.5132 secs
-----------------------
Epoch: 114, Train Loss: 0.2277, Train MSE: 0.2961, Train MAE: 0.3796
Epoch: 114, Valid Loss: 0.3559, Valid MSE: 0.4119, Valid MAE: 0.4318
No update
aggregation weights dict_items([('client_7', 0.24344769786390202), ('client_1', 0.25887259454315625), ('client_6', 0.23111857679783585), ('client_4', 0.2665611307951059)])
Epoch: 115, Training Time: 34.4887 secs
Epoch: 115, Validation Time: 1.4943 secs
-----------------------
Epoch: 115, Train Loss: 0.2230, Train MSE: 0.2829, Train MAE: 0.3714
Epoch: 115, Valid Loss: 0.3626, Valid MSE: 0.4123, Valid MAE: 0.4322
No update
aggregation weights dict_items([('client_9', 0.30529290619320704), ('client_2', 0.21427185328157336), ('client_3', 0.2197032101625397), ('client_8', 0.26073203036267995)])
Epoch: 116, Training Time: 34.7775 secs
Epoch: 116, Validation Time: 1.4087 secs
-----------------------
Epoch: 116, Train Loss: 0.2343, Train MSE: 0.3232, Train MAE: 0.3939
Epoch: 116, Valid Loss: 0.3585, Valid MSE: 0.4120, Valid MAE: 0.4318
No update
aggregation weights dict_items([('client_9', 0.2991613343270336), ('client_4', 0.2335884843574452), ('client_1', 0.23123515565910654), ('client_8', 0.2360150256564146)])
Epoch: 117, Training Time: 31.7001 secs
Epoch: 117, Validation Time: 1.3889 secs
-----------------------
Epoch: 117, Train Loss: 0.2535, Train MSE: 0.3536, Train MAE: 0.4127
Epoch: 117, Valid Loss: 0.3591, Valid MSE: 0.4108, Valid MAE: 0.4313
No update
aggregation weights dict_items([('client_5', 0.24805524729148992), ('client_3', 0.22158988634348165), ('client_10', 0.24773329732128657), ('client_9', 0.2826215690437417)])
Epoch: 118, Training Time: 37.1820 secs
Epoch: 118, Validation Time: 1.4982 secs
-----------------------
Epoch: 118, Train Loss: 0.2246, Train MSE: 0.3085, Train MAE: 0.3864
Epoch: 118, Valid Loss: 0.3553, Valid MSE: 0.4119, Valid MAE: 0.4319
No update
aggregation weights dict_items([('client_10', 0.26715072463467837), ('client_9', 0.28565299976725056), ('client_1', 0.2388906107778439), ('client_3', 0.2083056648202272)])
Epoch: 119, Training Time: 34.0487 secs
Epoch: 119, Validation Time: 1.4967 secs
-----------------------
Epoch: 119, Train Loss: 0.2271, Train MSE: 0.3018, Train MAE: 0.3819
Epoch: 119, Valid Loss: 0.3529, Valid MSE: 0.4120, Valid MAE: 0.4319
###Update tasks appear###
No update
aggregation weights dict_items([('client_4', 0.2739069604778025), ('client_2', 0.22268525070844683), ('client_8', 0.2916695489712793), ('client_3', 0.21173823984247153)])
Epoch: 120, Training Time: 34.3714 secs
Epoch: 120, Validation Time: 1.4807 secs
-----------------------
Epoch: 120, Train Loss: 0.2288, Train MSE: 0.3173, Train MAE: 0.3905
Epoch: 120, Valid Loss: 0.3581, Valid MSE: 0.4099, Valid MAE: 0.4307
No update
aggregation weights dict_items([('client_3', 0.21932602212698946), ('client_9', 0.26969894850642645), ('client_5', 0.2432239534742733), ('client_4', 0.26775107589231073)])
Epoch: 121, Training Time: 34.4728 secs
Epoch: 121, Validation Time: 1.4246 secs
-----------------------
Epoch: 121, Train Loss: 0.2291, Train MSE: 0.3236, Train MAE: 0.3946
Epoch: 121, Valid Loss: 0.3645, Valid MSE: 0.4109, Valid MAE: 0.4316
No update
aggregation weights dict_items([('client_4', 0.23944981174497068), ('client_6', 0.24322119212104087), ('client_10', 0.2784044335326639), ('client_3', 0.23892456260132458)])
Epoch: 122, Training Time: 34.5622 secs
Epoch: 122, Validation Time: 1.4857 secs
-----------------------
Epoch: 122, Train Loss: 0.2014, Train MSE: 0.2657, Train MAE: 0.3589
Epoch: 122, Valid Loss: 0.3621, Valid MSE: 0.4121, Valid MAE: 0.4324
No update
aggregation weights dict_items([('client_2', 0.23427390358471695), ('client_3', 0.23484815054485286), ('client_10', 0.27420405538438636), ('client_7', 0.2566738904860439)])
Epoch: 123, Training Time: 34.5560 secs
Epoch: 123, Validation Time: 1.3803 secs
-----------------------
Epoch: 123, Train Loss: 0.2088, Train MSE: 0.2716, Train MAE: 0.3642
Epoch: 123, Valid Loss: 0.3551, Valid MSE: 0.4140, Valid MAE: 0.4332
No update
aggregation weights dict_items([('client_9', 0.3089021205856529), ('client_2', 0.2203058994942881), ('client_3', 0.22816330938237028), ('client_1', 0.24262867053768863)])
Epoch: 124, Training Time: 34.4699 secs
Epoch: 124, Validation Time: 1.4708 secs
-----------------------
Epoch: 124, Train Loss: 0.2235, Train MSE: 0.2952, Train MAE: 0.3779
Epoch: 124, Valid Loss: 0.3564, Valid MSE: 0.4120, Valid MAE: 0.4320
No update
aggregation weights dict_items([('client_1', 0.24654800321190518), ('client_9', 0.27348433678482725), ('client_7', 0.2435394642473808), ('client_2', 0.23642819575588686)])
Epoch: 125, Training Time: 35.7349 secs
Epoch: 125, Validation Time: 1.5910 secs
-----------------------
Epoch: 125, Train Loss: 0.2318, Train MSE: 0.3072, Train MAE: 0.3861
Epoch: 125, Valid Loss: 0.3557, Valid MSE: 0.4122, Valid MAE: 0.4320
No update
aggregation weights dict_items([('client_7', 0.2511517668989508), ('client_2', 0.22306918257612915), ('client_8', 0.24007399349287922), ('client_5', 0.28570505703204074)])
Epoch: 126, Training Time: 34.0655 secs
Epoch: 126, Validation Time: 1.5609 secs
-----------------------
Epoch: 126, Train Loss: 0.2306, Train MSE: 0.3210, Train MAE: 0.3942
Epoch: 126, Valid Loss: 0.3548, Valid MSE: 0.4112, Valid MAE: 0.4315
No update
aggregation weights dict_items([('client_9', 0.30795425053410813), ('client_3', 0.2170142007672456), ('client_5', 0.23140968910872456), ('client_7', 0.2436218595899218)])
Epoch: 127, Training Time: 34.0457 secs
Epoch: 127, Validation Time: 1.4710 secs
-----------------------
Epoch: 127, Train Loss: 0.2211, Train MSE: 0.3064, Train MAE: 0.3860
Epoch: 127, Valid Loss: 0.3591, Valid MSE: 0.4141, Valid MAE: 0.4330
No update
aggregation weights dict_items([('client_2', 0.23272926307917757), ('client_7', 0.25085389857052975), ('client_5', 0.22977365101717412), ('client_8', 0.2866431873331186)])
Epoch: 128, Training Time: 34.1039 secs
Epoch: 128, Validation Time: 1.4271 secs
-----------------------
Epoch: 128, Train Loss: 0.2284, Train MSE: 0.3189, Train MAE: 0.3927
Epoch: 128, Valid Loss: 0.3562, Valid MSE: 0.4113, Valid MAE: 0.4313
No update
aggregation weights dict_items([('client_7', 0.2503092259961151), ('client_1', 0.23454212852629094), ('client_8', 0.2941797706903468), ('client_2', 0.22096887478724722)])
Epoch: 129, Training Time: 34.5441 secs
Epoch: 129, Validation Time: 1.4106 secs
-----------------------
Epoch: 129, Train Loss: 0.2321, Train MSE: 0.3179, Train MAE: 0.3920
Epoch: 129, Valid Loss: 0.3541, Valid MSE: 0.4087, Valid MAE: 0.4296
###Update tasks appear###
Test low! Updating! Test MSE: 0.3509, Test MAE: 0.3911, Test low! Updating! Valid Loss: 0.3541, epoch:  129
aggregation weights dict_items([('client_1', 0.23598030564195588), ('client_9', 0.31181053973610245), ('client_6', 0.22482220309391132), ('client_2', 0.2273869515280303)])
Epoch: 130, Training Time: 34.4091 secs
Epoch: 130, Validation Time: 1.3923 secs
-----------------------
Epoch: 130, Train Loss: 0.2143, Train MSE: 0.2798, Train MAE: 0.3684
Epoch: 130, Valid Loss: 0.3537, Valid MSE: 0.4092, Valid MAE: 0.4299
###Update tasks appear###
No update
aggregation weights dict_items([('client_5', 0.27113309105165423), ('client_9', 0.27290903522230453), ('client_10', 0.22790532090316581), ('client_1', 0.22805255282287543)])
Epoch: 131, Training Time: 34.9476 secs
Epoch: 131, Validation Time: 1.4876 secs
-----------------------
Epoch: 131, Train Loss: 0.2308, Train MSE: 0.3179, Train MAE: 0.3919
Epoch: 131, Valid Loss: 0.3503, Valid MSE: 0.4082, Valid MAE: 0.4295
###Update tasks appear###
No update
aggregation weights dict_items([('client_3', 0.22378225468547233), ('client_10', 0.2813561898569376), ('client_6', 0.2316478874342971), ('client_5', 0.26321366802329293)])
Epoch: 132, Training Time: 34.7499 secs
Epoch: 132, Validation Time: 1.4699 secs
-----------------------
Epoch: 132, Train Loss: 0.1954, Train MSE: 0.2585, Train MAE: 0.3550
Epoch: 132, Valid Loss: 0.3559, Valid MSE: 0.4101, Valid MAE: 0.4306
No update
aggregation weights dict_items([('client_5', 0.2680375221441225), ('client_2', 0.2332094793953784), ('client_1', 0.2331322781030237), ('client_10', 0.26562072035747536)])
Epoch: 133, Training Time: 36.8236 secs
Epoch: 133, Validation Time: 1.4970 secs
-----------------------
Epoch: 133, Train Loss: 0.2156, Train MSE: 0.2881, Train MAE: 0.3750
Epoch: 133, Valid Loss: 0.3528, Valid MSE: 0.4056, Valid MAE: 0.4284
###Update tasks appear###
No update
aggregation weights dict_items([('client_5', 0.25964016081540475), ('client_10', 0.27512203959335435), ('client_7', 0.25095325340717417), ('client_2', 0.21428454618406673)])
Epoch: 134, Training Time: 36.2837 secs
Epoch: 134, Validation Time: 1.4181 secs
-----------------------
Epoch: 134, Train Loss: 0.2127, Train MSE: 0.2883, Train MAE: 0.3752
Epoch: 134, Valid Loss: 0.3518, Valid MSE: 0.4085, Valid MAE: 0.4298
###Update tasks appear###
No update
aggregation weights dict_items([('client_7', 0.24707586862039932), ('client_10', 0.2760373943832692), ('client_6', 0.2204456384101439), ('client_8', 0.2564410985861876)])
Epoch: 135, Training Time: 36.2364 secs
Epoch: 135, Validation Time: 1.4814 secs
-----------------------
Epoch: 135, Train Loss: 0.2107, Train MSE: 0.2865, Train MAE: 0.3712
Epoch: 135, Valid Loss: 0.3576, Valid MSE: 0.4111, Valid MAE: 0.4310
No update
aggregation weights dict_items([('client_5', 0.22918846898648132), ('client_7', 0.26015071967695236), ('client_4', 0.2645537896982145), ('client_10', 0.2461070216383518)])
Epoch: 136, Training Time: 35.4220 secs
Epoch: 136, Validation Time: 1.4510 secs
-----------------------
Epoch: 136, Train Loss: 0.2155, Train MSE: 0.2973, Train MAE: 0.3805
Epoch: 136, Valid Loss: 0.3598, Valid MSE: 0.4097, Valid MAE: 0.4305
No update
aggregation weights dict_items([('client_2', 0.24592835873779545), ('client_1', 0.2314443490900344), ('client_7', 0.25823989004079406), ('client_8', 0.2643874021313761)])
Epoch: 137, Training Time: 35.6923 secs
Epoch: 137, Validation Time: 4.4331 secs
-----------------------
Epoch: 137, Train Loss: 0.2278, Train MSE: 0.3135, Train MAE: 0.3887
Epoch: 137, Valid Loss: 0.3485, Valid MSE: 0.4056, Valid MAE: 0.4277
###Update tasks appear###
Test low! Updating! Test MSE: 0.3471, Test MAE: 0.3885, Test low! Updating! Valid Loss: 0.3485, epoch:  137
aggregation weights dict_items([('client_6', 0.21966309477162366), ('client_9', 0.2945176112686945), ('client_1', 0.2351656649998021), ('client_10', 0.2506536289598797)])
Epoch: 138, Training Time: 35.6407 secs
Epoch: 138, Validation Time: 1.4843 secs
-----------------------
Epoch: 138, Train Loss: 0.2087, Train MSE: 0.2763, Train MAE: 0.3648
Epoch: 138, Valid Loss: 0.3471, Valid MSE: 0.4081, Valid MAE: 0.4290
###Update tasks appear###
No update
aggregation weights dict_items([('client_8', 0.27410239021407923), ('client_10', 0.2621262677494581), ('client_3', 0.2399778237124969), ('client_2', 0.22379351832396577)])
Epoch: 139, Training Time: 35.5777 secs
Epoch: 139, Validation Time: 1.4712 secs
-----------------------
Epoch: 139, Train Loss: 0.2100, Train MSE: 0.2934, Train MAE: 0.3752
Epoch: 139, Valid Loss: 0.3435, Valid MSE: 0.4076, Valid MAE: 0.4287
###Update tasks appear###
Test low! Updating! Test MSE: 0.3470, Test MAE: 0.3881, Test low! Updating! Valid Loss: 0.3435, epoch:  139
aggregation weights dict_items([('client_4', 0.2815682902887074), ('client_5', 0.24885693286942318), ('client_1', 0.24701681471242337), ('client_2', 0.22255796212944615)])
Epoch: 140, Training Time: 36.4908 secs
Epoch: 140, Validation Time: 1.4697 secs
-----------------------
Epoch: 140, Train Loss: 0.2200, Train MSE: 0.3068, Train MAE: 0.3856
Epoch: 140, Valid Loss: 0.3486, Valid MSE: 0.4031, Valid MAE: 0.4274
No update
aggregation weights dict_items([('client_5', 0.2570071212125772), ('client_9', 0.29241540804964333), ('client_10', 0.24969946779996255), ('client_2', 0.20087800293781694)])
Epoch: 141, Training Time: 39.0982 secs
Epoch: 141, Validation Time: 1.4765 secs
-----------------------
Epoch: 141, Train Loss: 0.2153, Train MSE: 0.2992, Train MAE: 0.3807
Epoch: 141, Valid Loss: 0.3444, Valid MSE: 0.4048, Valid MAE: 0.4276
No update
aggregation weights dict_items([('client_1', 0.24150788430965686), ('client_2', 0.2457748976779417), ('client_10', 0.29765695332601677), ('client_6', 0.21506026468638464)])
Epoch: 142, Training Time: 36.2415 secs
Epoch: 142, Validation Time: 1.4403 secs
-----------------------
Epoch: 142, Train Loss: 0.1943, Train MSE: 0.2534, Train MAE: 0.3510
Epoch: 142, Valid Loss: 0.3487, Valid MSE: 0.4046, Valid MAE: 0.4276
No update
aggregation weights dict_items([('client_2', 0.21383106099414798), ('client_8', 0.2804434938854704), ('client_4', 0.2523775928819719), ('client_5', 0.2533478522384097)])
Epoch: 143, Training Time: 34.5672 secs
Epoch: 143, Validation Time: 1.4485 secs
-----------------------
Epoch: 143, Train Loss: 0.2248, Train MSE: 0.3272, Train MAE: 0.3964
Epoch: 143, Valid Loss: 0.3464, Valid MSE: 0.4016, Valid MAE: 0.4262
No update
aggregation weights dict_items([('client_10', 0.24774497665935383), ('client_1', 0.2274386648262478), ('client_7', 0.2509720013312123), ('client_9', 0.27384435718318606)])
Epoch: 144, Training Time: 34.3807 secs
Epoch: 144, Validation Time: 1.4554 secs
-----------------------
Epoch: 144, Train Loss: 0.2191, Train MSE: 0.3009, Train MAE: 0.3805
Epoch: 144, Valid Loss: 0.3439, Valid MSE: 0.4066, Valid MAE: 0.4285
No update
aggregation weights dict_items([('client_2', 0.2148743240804298), ('client_9', 0.29816664100020696), ('client_8', 0.2642393867960912), ('client_3', 0.22271964812327205)])
Epoch: 145, Training Time: 34.2333 secs
Epoch: 145, Validation Time: 1.4857 secs
-----------------------
Epoch: 145, Train Loss: 0.2163, Train MSE: 0.3105, Train MAE: 0.3856
Epoch: 145, Valid Loss: 0.3434, Valid MSE: 0.4059, Valid MAE: 0.4276
###Update tasks appear###
Test low! Updating! Test MSE: 0.3458, Test MAE: 0.3868, Test low! Updating! Valid Loss: 0.3434, epoch:  145
aggregation weights dict_items([('client_6', 0.22635459290343293), ('client_9', 0.295533154514504), ('client_1', 0.2235539535329103), ('client_4', 0.2545582990491527)])
Epoch: 146, Training Time: 34.4548 secs
Epoch: 146, Validation Time: 1.4158 secs
-----------------------
Epoch: 146, Train Loss: 0.2107, Train MSE: 0.2895, Train MAE: 0.3726
Epoch: 146, Valid Loss: 0.3450, Valid MSE: 0.4030, Valid MAE: 0.4265
No update
aggregation weights dict_items([('client_5', 0.25109840563111036), ('client_4', 0.2510844826041672), ('client_6', 0.2099556552535802), ('client_9', 0.28786145651114226)])
Epoch: 147, Training Time: 34.5200 secs
Epoch: 147, Validation Time: 1.4039 secs
-----------------------
Epoch: 147, Train Loss: 0.2066, Train MSE: 0.2892, Train MAE: 0.3729
Epoch: 147, Valid Loss: 0.3549, Valid MSE: 0.4025, Valid MAE: 0.4263
No update
aggregation weights dict_items([('client_9', 0.3113622854052982), ('client_2', 0.21048796016431365), ('client_3', 0.2010700540534278), ('client_4', 0.2770797003769605)])
Epoch: 148, Training Time: 34.7107 secs
Epoch: 148, Validation Time: 1.5108 secs
-----------------------
Epoch: 148, Train Loss: 0.2077, Train MSE: 0.2927, Train MAE: 0.3752
Epoch: 148, Valid Loss: 0.3509, Valid MSE: 0.4042, Valid MAE: 0.4275
No update
aggregation weights dict_items([('client_1', 0.22680267862987258), ('client_4', 0.27209158913574283), ('client_9', 0.28720232644058313), ('client_6', 0.21390340579380146)])
Epoch: 149, Training Time: 34.4727 secs
Epoch: 149, Validation Time: 1.4304 secs
-----------------------
Epoch: 149, Train Loss: 0.2069, Train MSE: 0.2867, Train MAE: 0.3702
Epoch: 149, Valid Loss: 0.3466, Valid MSE: 0.4019, Valid MAE: 0.4263
No update
aggregation weights dict_items([('client_1', 0.22418449448941435), ('client_7', 0.2538090635468448), ('client_10', 0.25898082993075155), ('client_5', 0.2630256120329894)])
Epoch: 150, Training Time: 34.5535 secs
Epoch: 150, Validation Time: 1.5093 secs
-----------------------
Epoch: 150, Train Loss: 0.2098, Train MSE: 0.2908, Train MAE: 0.3747
Epoch: 150, Valid Loss: 0.3439, Valid MSE: 0.4014, Valid MAE: 0.4257
No update
aggregation weights dict_items([('client_3', 0.2241459819749604), ('client_8', 0.26050426892185446), ('client_1', 0.24764350623058856), ('client_10', 0.2677062428725966)])
Epoch: 151, Training Time: 33.6461 secs
Epoch: 151, Validation Time: 1.3644 secs
-----------------------
Epoch: 151, Train Loss: 0.2080, Train MSE: 0.2985, Train MAE: 0.3767
Epoch: 151, Valid Loss: 0.3402, Valid MSE: 0.4006, Valid MAE: 0.4252
###Update tasks appear###
No update
aggregation weights dict_items([('client_1', 0.25158179880258896), ('client_3', 0.24108586480359162), ('client_6', 0.23101182462430267), ('client_8', 0.27632051176951666)])
Epoch: 152, Training Time: 34.3576 secs
Epoch: 152, Validation Time: 1.5605 secs
-----------------------
Epoch: 152, Train Loss: 0.1961, Train MSE: 0.2756, Train MAE: 0.3626
Epoch: 152, Valid Loss: 0.3434, Valid MSE: 0.4007, Valid MAE: 0.4255
###Update tasks appear###
Test low! Updating! Test MSE: 0.3445, Test MAE: 0.3871, Test low! Updating! Valid Loss: 0.3434, epoch:  152
aggregation weights dict_items([('client_4', 0.23560970850936397), ('client_6', 0.21329796194183273), ('client_8', 0.26941574908113547), ('client_9', 0.2816765804676678)])
Epoch: 153, Training Time: 38.2699 secs
Epoch: 153, Validation Time: 1.3779 secs
-----------------------
Epoch: 153, Train Loss: 0.2121, Train MSE: 0.3067, Train MAE: 0.3807
Epoch: 153, Valid Loss: 0.3488, Valid MSE: 0.4003, Valid MAE: 0.4248
No update
aggregation weights dict_items([('client_3', 0.23788160103255232), ('client_8', 0.27839273471255543), ('client_5', 0.25211301411756465), ('client_2', 0.23161265013732754)])
Epoch: 154, Training Time: 34.2800 secs
Epoch: 154, Validation Time: 1.4619 secs
-----------------------
Epoch: 154, Train Loss: 0.2059, Train MSE: 0.3000, Train MAE: 0.3798
Epoch: 154, Valid Loss: 0.3412, Valid MSE: 0.4000, Valid MAE: 0.4251
###Update tasks appear###
Test low! Updating! Test MSE: 0.3432, Test MAE: 0.3845, Test low! Updating! Valid Loss: 0.3412, epoch:  154
aggregation weights dict_items([('client_9', 0.2623208587554258), ('client_4', 0.23017057424504375), ('client_1', 0.2552043955438377), ('client_7', 0.2523041714556927)])
Epoch: 155, Training Time: 35.4802 secs
Epoch: 155, Validation Time: 1.5626 secs
-----------------------
Epoch: 155, Train Loss: 0.2163, Train MSE: 0.3084, Train MAE: 0.3845
Epoch: 155, Valid Loss: 0.3403, Valid MSE: 0.3991, Valid MAE: 0.4243
###Update tasks appear###
No update
aggregation weights dict_items([('client_3', 0.1956296268867009), ('client_8', 0.2430275051459821), ('client_9', 0.3370566270075968), ('client_2', 0.22428624095972022)])
Epoch: 156, Training Time: 35.8632 secs
Epoch: 156, Validation Time: 1.4961 secs
-----------------------
Epoch: 156, Train Loss: 0.2077, Train MSE: 0.3039, Train MAE: 0.3800
Epoch: 156, Valid Loss: 0.3394, Valid MSE: 0.4013, Valid MAE: 0.4249
###Update tasks appear###
Test low! Updating! Test MSE: 0.3422, Test MAE: 0.3840, Test low! Updating! Valid Loss: 0.3394, epoch:  156
aggregation weights dict_items([('client_3', 0.2382551963087756), ('client_9', 0.26703264983370745), ('client_2', 0.21657423346179971), ('client_8', 0.27813792039571733)])
Epoch: 157, Training Time: 35.4474 secs
Epoch: 157, Validation Time: 1.4707 secs
-----------------------
Epoch: 157, Train Loss: 0.2061, Train MSE: 0.3033, Train MAE: 0.3799
Epoch: 157, Valid Loss: 0.3394, Valid MSE: 0.4019, Valid MAE: 0.4252
###Update tasks appear###
Test low! Updating! Test MSE: 0.3417, Test MAE: 0.3834, Test low! Updating! Valid Loss: 0.3394, epoch:  157
aggregation weights dict_items([('client_5', 0.28020843360853326), ('client_8', 0.2470913759003685), ('client_4', 0.2541483418718264), ('client_1', 0.21855184861927177)])
Epoch: 158, Training Time: 36.1296 secs
Epoch: 158, Validation Time: 4.3603 secs
-----------------------
Epoch: 158, Train Loss: 0.2192, Train MSE: 0.3275, Train MAE: 0.3964
Epoch: 158, Valid Loss: 0.3397, Valid MSE: 0.3960, Valid MAE: 0.4233
No update
aggregation weights dict_items([('client_7', 0.23949267855509698), ('client_2', 0.22744796709437054), ('client_8', 0.2718124648495028), ('client_10', 0.2612468895010296)])
Epoch: 159, Training Time: 35.1088 secs
Epoch: 159, Validation Time: 1.4315 secs
-----------------------
Epoch: 159, Train Loss: 0.2061, Train MSE: 0.2943, Train MAE: 0.3746
Epoch: 159, Valid Loss: 0.3360, Valid MSE: 0.3998, Valid MAE: 0.4240
###Update tasks appear###
Test low! Updating! Test MSE: 0.3405, Test MAE: 0.3835, Test low! Updating! Valid Loss: 0.3360, epoch:  159
aggregation weights dict_items([('client_6', 0.22440471566763778), ('client_3', 0.2231847081305426), ('client_7', 0.23572823057476466), ('client_5', 0.316682345627055)])
Epoch: 160, Training Time: 35.5408 secs
Epoch: 160, Validation Time: 1.4793 secs
-----------------------
Epoch: 160, Train Loss: 0.1822, Train MSE: 0.2525, Train MAE: 0.3496
Epoch: 160, Valid Loss: 0.3514, Valid MSE: 0.4014, Valid MAE: 0.4257
No update
aggregation weights dict_items([('client_9', 0.27498927645028837), ('client_5', 0.2444219691059092), ('client_8', 0.2554880072081486), ('client_3', 0.2251007472356539)])
Epoch: 161, Training Time: 35.7629 secs
Epoch: 161, Validation Time: 1.4634 secs
-----------------------
Epoch: 161, Train Loss: 0.2083, Train MSE: 0.3146, Train MAE: 0.3877
Epoch: 161, Valid Loss: 0.3434, Valid MSE: 0.3987, Valid MAE: 0.4238
No update
aggregation weights dict_items([('client_8', 0.2544273465380684), ('client_10', 0.2496974882528936), ('client_7', 0.21962980072165836), ('client_4', 0.2762453644873798)])
Epoch: 162, Training Time: 35.6558 secs
Epoch: 162, Validation Time: 1.4007 secs
-----------------------
Epoch: 162, Train Loss: 0.2099, Train MSE: 0.3089, Train MAE: 0.3826
Epoch: 162, Valid Loss: 0.3430, Valid MSE: 0.3979, Valid MAE: 0.4234
No update
aggregation weights dict_items([('client_2', 0.2354670037150444), ('client_7', 0.2502729266702979), ('client_10', 0.2835926356441826), ('client_1', 0.23066743397047515)])
Epoch: 163, Training Time: 35.3907 secs
Epoch: 163, Validation Time: 1.4048 secs
-----------------------
Epoch: 163, Train Loss: 0.1977, Train MSE: 0.2719, Train MAE: 0.3613
Epoch: 163, Valid Loss: 0.3366, Valid MSE: 0.3981, Valid MAE: 0.4233
No update
aggregation weights dict_items([('client_2', 0.21753870396391706), ('client_8', 0.24538648036296115), ('client_1', 0.24129260719403453), ('client_9', 0.2957822084790873)])
Epoch: 164, Training Time: 35.8630 secs
Epoch: 164, Validation Time: 1.4022 secs
-----------------------
Epoch: 164, Train Loss: 0.2128, Train MSE: 0.3157, Train MAE: 0.3867
Epoch: 164, Valid Loss: 0.3368, Valid MSE: 0.3952, Valid MAE: 0.4214
No update
aggregation weights dict_items([('client_6', 0.20856051341765905), ('client_9', 0.2674175235652728), ('client_5', 0.26039624673098277), ('client_1', 0.2636257162860854)])
Epoch: 165, Training Time: 35.1245 secs
Epoch: 165, Validation Time: 1.4339 secs
-----------------------
Epoch: 165, Train Loss: 0.1948, Train MSE: 0.2770, Train MAE: 0.3649
Epoch: 165, Valid Loss: 0.3372, Valid MSE: 0.3948, Valid MAE: 0.4216
No update
aggregation weights dict_items([('client_8', 0.24039032239152833), ('client_2', 0.21633096130893223), ('client_1', 0.2587088708583122), ('client_7', 0.2845698454412273)])
Epoch: 166, Training Time: 35.6442 secs
Epoch: 166, Validation Time: 1.4203 secs
-----------------------
Epoch: 166, Train Loss: 0.2031, Train MSE: 0.2964, Train MAE: 0.3763
Epoch: 166, Valid Loss: 0.3384, Valid MSE: 0.3960, Valid MAE: 0.4217
No update
aggregation weights dict_items([('client_6', 0.2248940077026714), ('client_3', 0.2244327676580343), ('client_8', 0.2987840699849938), ('client_1', 0.25188915465430045)])
Epoch: 167, Training Time: 35.4647 secs
Epoch: 167, Validation Time: 1.5645 secs
-----------------------
Epoch: 167, Train Loss: 0.1864, Train MSE: 0.2705, Train MAE: 0.3583
Epoch: 167, Valid Loss: 0.3382, Valid MSE: 0.3967, Valid MAE: 0.4227
No update
aggregation weights dict_items([('client_6', 0.22149324405819545), ('client_7', 0.24844128585172323), ('client_9', 0.2620134845245214), ('client_4', 0.26805198556555987)])
Epoch: 168, Training Time: 35.6721 secs
Epoch: 168, Validation Time: 1.4964 secs
-----------------------
Epoch: 168, Train Loss: 0.1928, Train MSE: 0.2734, Train MAE: 0.3603
Epoch: 168, Valid Loss: 0.3432, Valid MSE: 0.3975, Valid MAE: 0.4226
No update
aggregation weights dict_items([('client_8', 0.2613327636403205), ('client_6', 0.2374740544843302), ('client_2', 0.2166580910825397), ('client_9', 0.28453509079280964)])
Epoch: 169, Training Time: 35.5119 secs
Epoch: 169, Validation Time: 1.4549 secs
-----------------------
Epoch: 169, Train Loss: 0.1946, Train MSE: 0.2841, Train MAE: 0.3657
Epoch: 169, Valid Loss: 0.3342, Valid MSE: 0.3978, Valid MAE: 0.4224
###Update tasks appear###
Test low! Updating! Test MSE: 0.3327, Test MAE: 0.3777, Test low! Updating! Valid Loss: 0.3342, epoch:  169
aggregation weights dict_items([('client_7', 0.23012621918812862), ('client_8', 0.24991862337126797), ('client_3', 0.20691892289613087), ('client_9', 0.31303623454447255)])
Epoch: 170, Training Time: 32.5688 secs
Epoch: 170, Validation Time: 1.3881 secs
-----------------------
Epoch: 170, Train Loss: 0.2005, Train MSE: 0.3032, Train MAE: 0.3779
Epoch: 170, Valid Loss: 0.3372, Valid MSE: 0.3984, Valid MAE: 0.4224
No update
aggregation weights dict_items([('client_9', 0.2775589291059803), ('client_10', 0.2428320437576879), ('client_2', 0.22664572140996594), ('client_5', 0.2529633057263657)])
Epoch: 171, Training Time: 36.8577 secs
Epoch: 171, Validation Time: 1.3914 secs
-----------------------
Epoch: 171, Train Loss: 0.1973, Train MSE: 0.2859, Train MAE: 0.3691
Epoch: 171, Valid Loss: 0.3289, Valid MSE: 0.3960, Valid MAE: 0.4219
###Update tasks appear###
No update
aggregation weights dict_items([('client_8', 0.26005910340070176), ('client_6', 0.20522812819450306), ('client_4', 0.3018499578491779), ('client_3', 0.23286281055561722)])
Epoch: 172, Training Time: 34.9547 secs
Epoch: 172, Validation Time: 1.4231 secs
-----------------------
Epoch: 172, Train Loss: 0.1848, Train MSE: 0.2718, Train MAE: 0.3589
Epoch: 172, Valid Loss: 0.3422, Valid MSE: 0.3963, Valid MAE: 0.4231
No update
aggregation weights dict_items([('client_1', 0.25851183248729226), ('client_3', 0.2644065339651407), ('client_5', 0.2679214446600653), ('client_6', 0.2091601888875017)])
Epoch: 173, Training Time: 36.1067 secs
Epoch: 173, Validation Time: 1.4006 secs
-----------------------
Epoch: 173, Train Loss: 0.1777, Train MSE: 0.2536, Train MAE: 0.3484
Epoch: 173, Valid Loss: 0.3388, Valid MSE: 0.3963, Valid MAE: 0.4242
No update
aggregation weights dict_items([('client_9', 0.30890132943366927), ('client_6', 0.21620250041671926), ('client_7', 0.25924870947428835), ('client_2', 0.2156474606753231)])
Epoch: 174, Training Time: 36.0297 secs
Epoch: 174, Validation Time: 1.4370 secs
-----------------------
Epoch: 174, Train Loss: 0.1817, Train MSE: 0.2558, Train MAE: 0.3498
Epoch: 174, Valid Loss: 0.3343, Valid MSE: 0.3985, Valid MAE: 0.4232
No update
aggregation weights dict_items([('client_7', 0.26881061515074994), ('client_4', 0.277352544660322), ('client_8', 0.23327576838288525), ('client_2', 0.2205610718060427)])
Epoch: 175, Training Time: 35.4340 secs
Epoch: 175, Validation Time: 1.4791 secs
-----------------------
Epoch: 175, Train Loss: 0.2002, Train MSE: 0.2987, Train MAE: 0.3772
Epoch: 175, Valid Loss: 0.3299, Valid MSE: 0.3957, Valid MAE: 0.4222
###Update tasks appear###
No update
aggregation weights dict_items([('client_9', 0.26989119264780326), ('client_2', 0.22574241207545448), ('client_10', 0.26333162100511315), ('client_1', 0.24103477427162914)])
Epoch: 176, Training Time: 36.1541 secs
Epoch: 176, Validation Time: 1.4615 secs
-----------------------
Epoch: 176, Train Loss: 0.1937, Train MSE: 0.2781, Train MAE: 0.3632
Epoch: 176, Valid Loss: 0.3312, Valid MSE: 0.3941, Valid MAE: 0.4209
###Update tasks appear###
No update
aggregation weights dict_items([('client_1', 0.22282595073431002), ('client_3', 0.23345678401505868), ('client_5', 0.2956990782685123), ('client_10', 0.24801818698211892)])
Epoch: 177, Training Time: 36.7862 secs
Epoch: 177, Validation Time: 1.4586 secs
-----------------------
Epoch: 177, Train Loss: 0.1851, Train MSE: 0.2718, Train MAE: 0.3597
Epoch: 177, Valid Loss: 0.3332, Valid MSE: 0.3962, Valid MAE: 0.4238
###Update tasks appear###
No update
aggregation weights dict_items([('client_5', 0.25572778662943896), ('client_2', 0.23645805644920098), ('client_6', 0.2235774310174602), ('client_8', 0.2842367259038998)])
Epoch: 178, Training Time: 39.9789 secs
Epoch: 178, Validation Time: 1.6417 secs
-----------------------
Epoch: 178, Train Loss: 0.1849, Train MSE: 0.2726, Train MAE: 0.3607
Epoch: 178, Valid Loss: 0.3357, Valid MSE: 0.3938, Valid MAE: 0.4218
No update
aggregation weights dict_items([('client_2', 0.20865747347903832), ('client_10', 0.25902153633559616), ('client_5', 0.2492038595541985), ('client_1', 0.28311713063116717)])
Epoch: 179, Training Time: 36.5688 secs
Epoch: 179, Validation Time: 1.6214 secs
-----------------------
Epoch: 179, Train Loss: 0.1870, Train MSE: 0.2725, Train MAE: 0.3615
Epoch: 179, Valid Loss: 0.3398, Valid MSE: 0.3931, Valid MAE: 0.4221
No update
aggregation weights dict_items([('client_1', 0.21835326012993558), ('client_10', 0.24914888658871373), ('client_5', 0.261762669139853), ('client_4', 0.2707351841414977)])
Epoch: 180, Training Time: 32.9409 secs
Epoch: 180, Validation Time: 1.5249 secs
-----------------------
Epoch: 180, Train Loss: 0.1922, Train MSE: 0.2842, Train MAE: 0.3686
Epoch: 180, Valid Loss: 0.3343, Valid MSE: 0.3938, Valid MAE: 0.4234
No update
aggregation weights dict_items([('client_5', 0.26815289428104594), ('client_2', 0.2498804740407012), ('client_8', 0.2517681740164784), ('client_3', 0.23019845766177455)])
Epoch: 181, Training Time: 39.8352 secs
Epoch: 181, Validation Time: 1.5863 secs
-----------------------
Epoch: 181, Train Loss: 0.1876, Train MSE: 0.2850, Train MAE: 0.3688
Epoch: 181, Valid Loss: 0.3340, Valid MSE: 0.3951, Valid MAE: 0.4238
###Update tasks appear###
No update
aggregation weights dict_items([('client_9', 0.28041376887511904), ('client_3', 0.22322089818540616), ('client_2', 0.25126638313542), ('client_7', 0.24509894980405486)])
Epoch: 182, Training Time: 33.2545 secs
Epoch: 182, Validation Time: 1.4187 secs
-----------------------
Epoch: 182, Train Loss: 0.1841, Train MSE: 0.2688, Train MAE: 0.3575
Epoch: 182, Valid Loss: 0.3317, Valid MSE: 0.3979, Valid MAE: 0.4239
###Update tasks appear###
No update
aggregation weights dict_items([('client_6', 0.2248951715445277), ('client_5', 0.2759057658151129), ('client_1', 0.23446981813499307), ('client_10', 0.26472924450536645)])
Epoch: 183, Training Time: 38.6107 secs
Epoch: 183, Validation Time: 1.6428 secs
-----------------------
Epoch: 183, Train Loss: 0.1757, Train MSE: 0.2517, Train MAE: 0.3465
Epoch: 183, Valid Loss: 0.3357, Valid MSE: 0.3932, Valid MAE: 0.4219
No update
aggregation weights dict_items([('client_3', 0.2313514945234441), ('client_6', 0.2241329220403013), ('client_10', 0.2740643368686473), ('client_8', 0.2704512465676074)])
Epoch: 184, Training Time: 34.8800 secs
Epoch: 184, Validation Time: 1.4372 secs
-----------------------
Epoch: 184, Train Loss: 0.1740, Train MSE: 0.2563, Train MAE: 0.3468
Epoch: 184, Valid Loss: 0.3336, Valid MSE: 0.3949, Valid MAE: 0.4219
###Update tasks appear###
Test low! Updating! Test MSE: 0.3319, Test MAE: 0.3777, Test low! Updating! Valid Loss: 0.3336, epoch:  184
aggregation weights dict_items([('client_8', 0.259904854608699), ('client_4', 0.26518848594345323), ('client_3', 0.2221228852399384), ('client_10', 0.2527837742079094)])
Epoch: 185, Training Time: 32.1522 secs
Epoch: 185, Validation Time: 1.6734 secs
-----------------------
Epoch: 185, Train Loss: 0.1876, Train MSE: 0.2854, Train MAE: 0.3656
Epoch: 185, Valid Loss: 0.3331, Valid MSE: 0.3938, Valid MAE: 0.4221
###Update tasks appear###
No update
aggregation weights dict_items([('client_3', 0.24206484201350734), ('client_9', 0.3184210029655346), ('client_6', 0.22333612785204618), ('client_1', 0.21617802716891196)])
Epoch: 186, Training Time: 35.8769 secs
Epoch: 186, Validation Time: 1.4638 secs
-----------------------
Epoch: 186, Train Loss: 0.1732, Train MSE: 0.2499, Train MAE: 0.3440
Epoch: 186, Valid Loss: 0.3270, Valid MSE: 0.3924, Valid MAE: 0.4209
###Update tasks appear###
No update
aggregation weights dict_items([('client_9', 0.25984529944457097), ('client_7', 0.23642803104789553), ('client_4', 0.25543944410571917), ('client_8', 0.24828722540181433)])
Epoch: 187, Training Time: 33.2090 secs
Epoch: 187, Validation Time: 1.4895 secs
-----------------------
Epoch: 187, Train Loss: 0.2036, Train MSE: 0.3123, Train MAE: 0.3831
Epoch: 187, Valid Loss: 0.3322, Valid MSE: 0.3901, Valid MAE: 0.4182
###Update tasks appear###
Test low! Updating! Test MSE: 0.3308, Test MAE: 0.3761, Test low! Updating! Valid Loss: 0.3322, epoch:  187
aggregation weights dict_items([('client_6', 0.24724944426019438), ('client_7', 0.21598405026136056), ('client_9', 0.26533269980959456), ('client_2', 0.2714338056688506)])
Epoch: 188, Training Time: 40.2980 secs
Epoch: 188, Validation Time: 1.6107 secs
-----------------------
Epoch: 188, Train Loss: 0.1741, Train MSE: 0.2475, Train MAE: 0.3431
Epoch: 188, Valid Loss: 0.3251, Valid MSE: 0.3936, Valid MAE: 0.4201
###Update tasks appear###
Test low! Updating! Test MSE: 0.3279, Test MAE: 0.3728, Test low! Updating! Valid Loss: 0.3251, epoch:  188
aggregation weights dict_items([('client_7', 0.21806448196146735), ('client_3', 0.2619508423648364), ('client_9', 0.2571374784425098), ('client_4', 0.26284719723118644)])
Epoch: 189, Training Time: 32.7190 secs
Epoch: 189, Validation Time: 1.4364 secs
-----------------------
Epoch: 189, Train Loss: 0.1843, Train MSE: 0.2770, Train MAE: 0.3605
Epoch: 189, Valid Loss: 0.3334, Valid MSE: 0.3928, Valid MAE: 0.4205
No update
aggregation weights dict_items([('client_1', 0.2517397303572893), ('client_6', 0.23014071341839945), ('client_8', 0.2539839915303733), ('client_10', 0.264135564693938)])
Epoch: 190, Training Time: 38.5708 secs
Epoch: 190, Validation Time: 1.4827 secs
-----------------------
Epoch: 190, Train Loss: 0.1807, Train MSE: 0.2645, Train MAE: 0.3524
Epoch: 190, Valid Loss: 0.3242, Valid MSE: 0.3897, Valid MAE: 0.4186
###Update tasks appear###
No update
aggregation weights dict_items([('client_1', 0.23313452063608578), ('client_9', 0.24078603343737628), ('client_6', 0.2705630009318714), ('client_7', 0.25551644499466647)])
Epoch: 191, Training Time: 34.3309 secs
Epoch: 191, Validation Time: 1.4954 secs
-----------------------
Epoch: 191, Train Loss: 0.1771, Train MSE: 0.2576, Train MAE: 0.3485
Epoch: 191, Valid Loss: 0.3285, Valid MSE: 0.3898, Valid MAE: 0.4180
No update
aggregation weights dict_items([('client_1', 0.2536415232660603), ('client_5', 0.2712965419598219), ('client_10', 0.24731118396664392), ('client_7', 0.22775075080747384)])
Epoch: 192, Training Time: 38.3437 secs
Epoch: 192, Validation Time: 1.7683 secs
-----------------------
Epoch: 192, Train Loss: 0.1845, Train MSE: 0.2721, Train MAE: 0.3595
Epoch: 192, Valid Loss: 0.3266, Valid MSE: 0.3881, Valid MAE: 0.4177
No update
aggregation weights dict_items([('client_5', 0.24810395912258956), ('client_9', 0.26552185937829037), ('client_10', 0.2255023084939456), ('client_8', 0.26087187300517456)])
Epoch: 193, Training Time: 33.7548 secs
Epoch: 193, Validation Time: 1.4026 secs
-----------------------
Epoch: 193, Train Loss: 0.1973, Train MSE: 0.3072, Train MAE: 0.3797
Epoch: 193, Valid Loss: 0.3267, Valid MSE: 0.3863, Valid MAE: 0.4162
No update
aggregation weights dict_items([('client_9', 0.26153813809388776), ('client_2', 0.25761733011739796), ('client_7', 0.25297791600864855), ('client_5', 0.22786661578006573)])
Epoch: 194, Training Time: 36.2270 secs
Epoch: 194, Validation Time: 1.4353 secs
-----------------------
Epoch: 194, Train Loss: 0.1858, Train MSE: 0.2770, Train MAE: 0.3628
Epoch: 194, Valid Loss: 0.3225, Valid MSE: 0.3881, Valid MAE: 0.4172
###Update tasks appear###
No update
aggregation weights dict_items([('client_1', 0.2598582801693329), ('client_3', 0.21944930807532442), ('client_9', 0.26592150650984525), ('client_8', 0.2547709052454974)])
Epoch: 195, Training Time: 35.0627 secs
Epoch: 195, Validation Time: 1.4624 secs
-----------------------
Epoch: 195, Train Loss: 0.1900, Train MSE: 0.2939, Train MAE: 0.3711
Epoch: 195, Valid Loss: 0.3209, Valid MSE: 0.3862, Valid MAE: 0.4165
###Update tasks appear###
No update
aggregation weights dict_items([('client_6', 0.23214683190808574), ('client_8', 0.2592703978904668), ('client_7', 0.23562937488519517), ('client_9', 0.27295339531625235)])
Epoch: 196, Training Time: 38.9923 secs
Epoch: 196, Validation Time: 1.4549 secs
-----------------------
Epoch: 196, Train Loss: 0.1815, Train MSE: 0.2751, Train MAE: 0.3586
Epoch: 196, Valid Loss: 0.3335, Valid MSE: 0.3882, Valid MAE: 0.4161
No update
aggregation weights dict_items([('client_6', 0.227455542152468), ('client_10', 0.23566803976951683), ('client_5', 0.2888537556246824), ('client_1', 0.2480226624533327)])
Epoch: 197, Training Time: 32.6749 secs
Epoch: 197, Validation Time: 1.5250 secs
-----------------------
Epoch: 197, Train Loss: 0.1711, Train MSE: 0.2475, Train MAE: 0.3432
Epoch: 197, Valid Loss: 0.3282, Valid MSE: 0.3865, Valid MAE: 0.4173
No update
aggregation weights dict_items([('client_8', 0.24758465610539665), ('client_9', 0.2800700280709522), ('client_3', 0.22147026494386565), ('client_4', 0.25087505087978546)])
Epoch: 198, Training Time: 35.2232 secs
Epoch: 198, Validation Time: 1.5606 secs
-----------------------
Epoch: 198, Train Loss: 0.1910, Train MSE: 0.2971, Train MAE: 0.3719
Epoch: 198, Valid Loss: 0.3274, Valid MSE: 0.3858, Valid MAE: 0.4166
No update
aggregation weights dict_items([('client_8', 0.2399934628358648), ('client_6', 0.21856602004182482), ('client_9', 0.25497080083529405), ('client_4', 0.28646971628701634)])
Epoch: 199, Training Time: 35.2896 secs
Epoch: 199, Validation Time: 1.4338 secs
-----------------------
Epoch: 199, Train Loss: 0.1837, Train MSE: 0.2847, Train MAE: 0.3634
Epoch: 199, Valid Loss: 0.3323, Valid MSE: 0.3857, Valid MAE: 0.4166
No update
aggregation weights dict_items([('client_1', 0.24423314455802783), ('client_8', 0.2764015063964193), ('client_2', 0.25736482055879933), ('client_4', 0.22200052848675353)])
Epoch: 200, Training Time: 38.2608 secs
Epoch: 200, Validation Time: 1.5466 secs
-----------------------
Epoch: 200, Train Loss: 0.1938, Train MSE: 0.2930, Train MAE: 0.3721
Epoch: 200, Valid Loss: 0.3209, Valid MSE: 0.3871, Valid MAE: 0.4183
###Update tasks appear###
Test low! Updating! Test MSE: 0.3245, Test MAE: 0.3724, Test low! Updating! Valid Loss: 0.3209, epoch:  200
Average Training Time: 34.9997 secs/epoch
Average Validation Time: 1.5538 secs
Training ends
The epoch of the best result: 200
The valid loss of the best model 0.3209
Test time (total): 8.9812 seconds
On average horizons, Test MSE: 0.3245, Test MAE: 0.3724
Total time spent: 8052.1883
